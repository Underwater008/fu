<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Á¶è ‚Äî Fortune Gacha</title>
    <link rel="icon" type="image/svg+xml" href="./favicon.svg">

    <!-- Open Graph / Discord / Social preview -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://fuduoduo.xyz/">
    <meta property="og:title" content="Á¶è Fortune Gacha">
    <meta property="og:description" content="Draw your fortune! A Chinese New Year gacha experience ‚Äî collect lucky characters, blessings, and zodiac signs.">
    <meta property="og:image" content="https://fuduoduo.xyz/image/og-image.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">

    <!-- Twitter/X card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Á¶è Fortune Gacha">
    <meta name="twitter:description" content="Draw your fortune! A Chinese New Year gacha experience ‚Äî collect lucky characters, blessings, and zodiac signs.">
    <meta name="twitter:image" content="https://fuduoduo.xyz/image/og-image.png">

    <!-- Discord accent color (festive red) -->
    <meta name="theme-color" content="#e53935">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@400;500;600;700&family=Liu+Jian+Mao+Cao&family=Ma+Shan+Zheng&family=Zhi+Mang+Xing&family=Noto+Serif+TC:wght@400;700&family=Long+Cang&family=ZCOOL+XiaoWei&text=%E7%A6%8F%E7%A6%84%E5%AF%BF%E5%96%9C%E8%B4%A2%E5%AF%8C%E8%B4%B5%E5%8F%91%E9%87%91%E7%8E%89%E5%AE%9D%E4%BD%99%E4%B8%B0%E7%9B%9B%E5%88%A9%E6%97%BA%E9%9A%86%E6%98%8C%E5%85%B4%E8%BF%9B%E5%AE%89%E5%BA%B7%E5%AE%81%E6%B3%B0%E5%92%8C%E5%B9%B3%E9%A1%BA%E5%81%A5%E4%B9%90%E6%AC%A2%E5%BA%86%E7%A6%A7%E7%A5%BA%E5%98%89%E6%98%A5%E5%BE%B7%E5%96%84%E4%BB%81%E4%B9%89%E5%BF%A0%E4%BF%A1%E5%AD%9D%E6%85%A7%E6%81%A9%E7%88%B1%E5%90%88%E5%9C%86%E6%BB%A1%E7%BE%8E%E9%A6%A8%E9%9B%85%E5%90%89%E7%A5%A5%E7%91%9E%E5%A6%82%E6%84%8F%E7%A5%9D%E8%BF%90%E9%BE%99%E5%87%A4%E9%BA%9F%E9%B9%A4%E5%8D%8E%E6%88%90%E5%8D%87%E7%99%BB%E9%AB%98%E9%93%B6%E7%8F%A0%E9%9D%99%E6%82%A0%E7%A8%B3%E7%AC%91%E6%82%A6%E6%80%A1%E7%A4%BC%E5%BB%89%E7%BC%98%E6%83%85%E7%94%9C%E5%B9%B8%E5%85%86%E8%B4%BA%E9%BA%92%E5%87%B0%E9%B9%BF%E8%BE%BE%E8%BE%89%C2%B7%E4%B8%80%E4%BA%BA%E5%8D%81%E5%A4%A7%E5%A4%9A%E5%85%B8%E9%BC%A0%E7%89%9B%E8%99%8E%E5%85%94%E9%BE%8D%E8%9B%87%E9%A6%AC%E7%BE%8A%E7%8C%B4%E9%9B%9E%E7%8B%97%E8%B1%AC%E7%94%B2%E4%B9%99%E4%B8%99%E4%B8%81%E6%88%8A%E5%B7%B1%E5%BA%9A%E8%BE%9B%E5%A3%AC%E7%99%B8%E5%AD%90%E4%B8%91%E5%AF%85%E5%8D%AF%E8%BE%B0%E5%B7%B3%E5%8D%88%E6%9C%AA%E7%94%B3%E9%85%89%E6%88%8C%E4%BA%A5%E5%B9%B4%E9%A9%AC&display=swap">
    <link rel="stylesheet" href="https://unpkg.com/@chinese-fonts/cezkzdbs@3.0.0/dist/%E4%BB%93%E8%80%B3%E5%91%A8%E7%8F%82%E6%AD%A3%E5%A4%A7%E6%A6%9C%E4%B9%A6/result.css">
    <link rel="stylesheet" href="https://unpkg.com/@chinese-fonts/hlxsjt@3.0.0/dist/%E9%B8%BF%E9%9B%B7%E8%A1%8C%E4%B9%A6%E7%AE%80%E4%BD%93/result.css">
    <link rel="stylesheet" href="https://unpkg.com/@chinese-fonts/qtbfsxt@3.0.0/dist/%E5%8D%83%E5%9B%BE%E7%AC%94%E9%94%8B%E6%89%8B%E5%86%99%E4%BD%93/result.css">
    <link rel="stylesheet" href="https://unpkg.com/@chinese-fonts/ysbzt@3.0.0/dist/%E5%B3%84%E5%B1%B1%E7%A2%91%E7%AF%86%E4%BD%93/result.css">
    <link rel="stylesheet" href="./style.css">
    <script>
        window.adsbygoogle = window.adsbygoogle || [];
        const adBreak = adConfig = function(o) { adsbygoogle.push(o); };
    </script>
    <script async
        src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3508859821519597"
        crossorigin="anonymous">
    </script>
</head>
<body>
    <canvas id="c"></canvas>

    <!-- Draw counter (moved into bottom-controls) -->

    <!-- Login modal -->
    <div id="login-modal" class="modal-overlay" style="display:none">
        <div class="modal-card">
            <h2>Sign In</h2>
            <p>Enter your email to receive a magic link</p>
            <input type="email" id="login-email" placeholder="your@email.com" class="input-email" />
            <button id="btn-send-link" class="btn-action btn-primary">Send Magic Link</button>
            <button id="btn-close-login" class="btn-action btn-secondary">Cancel</button>
            <p id="login-status" class="login-status"></p>
        </div>
    </div>

    <!-- Payment modal (Stripe Elements) -->
    <div id="payment-modal" class="modal-overlay" style="display:none">
        <div class="modal-card payment-modal-card">
            <h2 id="payment-title">Buy Draws</h2>
            <p id="payment-desc"></p>
            <div id="payment-element"></div>
            <div class="promo-code-row">
                <input id="promo-code" type="text" placeholder="Promo code (optional)" autocomplete="off">
                <button id="btn-apply-promo" class="btn-action btn-secondary">Apply</button>
            </div>
            <p id="payment-status" class="payment-status"></p>
            <button id="btn-pay" class="btn-action btn-primary" disabled>Pay</button>
            <button id="btn-close-payment" class="btn-action btn-secondary">Cancel</button>
        </div>
    </div>

    <!-- Rewards panel (slide-up drawer) -->
    <div id="rewards-panel-backdrop" class="rewards-backdrop" style="display:none"></div>
    <div id="rewards-panel" class="rewards-panel" style="display:none">
        <div class="rewards-handle"><span class="rewards-handle-bar"></span></div>
        <div class="rewards-header">
            <span class="rewards-title">Get More Draws</span>
            <button id="btn-close-rewards" class="rewards-close">
                <svg width="14" height="14" viewBox="0 0 14 14" fill="none"><path d="M1 1l12 12M13 1L1 13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
            </button>
        </div>

        <div class="rewards-content">
            <!-- Sign In prompt (hidden when logged in) -->
            <div id="auth-logged-out" class="rewards-signin-row">
                <button id="btn-login" class="rewards-btn rewards-btn--fill rewards-signin-btn">
                    <span>Sign In</span><span class="rewards-btn-badge">Save Progress</span>
                </button>
            </div>
            <!-- Logged-in user info (hidden when logged out) -->
            <div id="auth-logged-in" class="rewards-user-row" style="display:none">
                <button id="btn-auth-user" class="rewards-user-badge"></button>
                <div id="auth-dropdown" class="auth-dropdown" style="display:none">
                    <span id="auth-email" class="auth-email"></span>
                    <button id="btn-logout" class="rewards-btn rewards-btn--fill rewards-btn--small">Logout</button>
                </div>
            </div>

            <!-- Free draws section -->
            <div class="rewards-section">
                <span class="rewards-section-label">Free</span>

                <div class="rewards-row rewards-row--actions">
                    <button id="login-streak-btn" class="rewards-btn rewards-btn--fill">
                        <span>Login</span><span class="rewards-btn-badge">+6 daily</span><div id="login-streak" class="streak-dots"></div>
                    </button>
                    <button id="btn-share-draw" class="rewards-btn rewards-btn--fill">
                        <span>Share</span><span class="rewards-btn-badge">+10</span>
                    </button>
                    <button id="btn-watch-ad" class="rewards-btn rewards-btn--fill">
                        <span>Ad</span><span class="rewards-btn-badge">+6</span>
                    </button>
                    <button id="btn-copy-referral" class="rewards-btn rewards-btn--fill">
                        <span>Invite</span><span class="rewards-btn-badge">+30</span>
                    </button>
                </div>
            </div>

            <!-- Purchase section -->
            <div class="rewards-section">
                <span class="rewards-section-label">Shop</span>
                <div id="purchase-bundles" class="purchase-grid"></div>
            </div>
        </div>
    </div>

    <!-- Bottom Controls -->
    <div class="bottom-controls">
        <!-- Audio mute toggle -->
        <button id="btn-mute" class="mute-btn" title="Toggle Sound">
            <svg class="mute-icon icon-sound" viewBox="0 0 24 24" width="24" height="24">
                <path fill="currentColor" d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>
            </svg>
            <svg class="mute-icon icon-muted" viewBox="0 0 24 24" width="24" height="24">
                <path fill="currentColor" d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73 4.27 3zM12 4L9.91 6.09 12 8.18V4z"/>
            </svg>
        </button>

        <button id="btn-collection" class="collection-fab">COLLECTION</button>

        <div id="draw-counter-float" class="draw-counter-float">
            <span id="draw-counter" class="draw-counter">üé´ √ó0</span>
        </div>

        <div id="mode-switch" class="mode-switch">
            <div class="switch-track"></div>
            <div class="switch-option active" data-mode="single">√ó1</div>
            <div class="switch-option" data-mode="multi">√ó10</div>
        </div>
    </div>

    <!-- Multi-pull results overlay (legacy, hidden) -->
    <div id="multi-overlay">
        <div class="multi-title">ÂçÅËøûÁªìÊûú</div>
        <div id="multi-grid" class="multi-grid"></div>
    </div>

    <!-- Multi-fortune floating action buttons -->
    <div class="multi-fortune-actions" id="multi-fortune-actions">
        <button class="btn-action btn-primary" id="btn-reveal-all" style="display:none">REVEAL ALL</button>
        <button class="btn-action btn-primary" id="btn-multi-again" style="display:none">DRAW x10</button>
        <button class="btn-action btn-secondary" id="btn-multi-single" style="display:none">SINGLE (x1)</button>
        <button class="btn-action btn-secondary" id="btn-multi-collection" style="display:none">COLLECTION</button>
    </div>

    <!-- Detail popup (shared by multi-pull, single-pull, collection) -->
    <div id="multi-detail">
        <div class="detail-dialog">
            <div class="detail-card" id="detail-card">
                <div class="detail-card-ornaments" aria-hidden="true">
                    <span class="orn-corner orn-tl"></span>
                    <span class="orn-corner orn-tr"></span>
                    <span class="orn-corner orn-bl"></span>
                    <span class="orn-corner orn-br"></span>
                    <span class="orn-center orn-top"></span>
                    <span class="orn-center orn-bottom"></span>
                    <span class="orn-side orn-left"></span>
                    <span class="orn-side orn-right"></span>
                    <span class="orn-cloud orn-cloud-top"></span>
                    <span class="orn-cloud orn-cloud-bottom"></span>
                    <span class="orn-seal-dots"></span>
                </div>
                <div class="detail-category" id="detail-category"></div>
                <div class="detail-stars" id="detail-stars"></div>
                <div class="detail-character" id="detail-character"></div>
                <div class="detail-char-en" id="detail-char-en"></div>
                <div class="detail-divider"></div>
                <div class="detail-phrase" id="detail-phrase"></div>
                <div class="detail-english" id="detail-english"></div>
            </div>
            <div class="detail-actions detail-actions-outside">
                <button class="btn-detail-action" id="btn-detail-share">Share</button>
                <button class="btn-detail-action btn-detail-gift" id="btn-detail-gift" style="display:none">Gift</button>
                <button class="btn-detail-action btn-detail-sound btn-detail-pronunciation" id="btn-detail-sound" title="Play pronunciation">Pronunciation</button>
            </div>
        </div>
    </div>

    <!-- Collection panel -->
    <div id="collection-panel">
        <div class="collection-header">
            <!-- Title left + Progress right -->
            <div class="collection-hero-row">
                <h1 class="collection-title-en">
                    <span class="collection-title-main">FUDUODUO</span>
                    <span class="collection-title-sub">COLLECTION</span>
                    <span class="collection-title-cn">Á¶èÂ§öÂ§öÂÆùÂÖ∏</span>
                </h1>
                <div id="collection-progress" class="collection-progress-center"></div>
            </div>
        </div>
        <div id="collection-grid" class="collection-grid"></div>
        <div class="collection-actions">
            <button class="collection-pill-btn" id="btn-close-collection">CLOSE</button>
        </div>
    </div>

    <!-- Share Preview Modal -->
    <div id="share-preview-backdrop" class="share-preview-backdrop" style="display:none"></div>
    <div id="share-preview-modal" class="share-preview-modal" style="display:none">
        <div class="share-preview-inner">
            <img id="share-preview-img" class="share-preview-img" alt="Share preview" />
            <div class="share-preview-actions">
                <button id="btn-share-confirm" class="btn-action btn-primary share-preview-btn">Share</button>
                <button id="btn-share-download" class="btn-action btn-secondary share-preview-btn">Save Image</button>
                <button id="btn-share-close" class="btn-action btn-secondary share-preview-btn">Cancel</button>
            </div>
        </div>
    </div>

    <div id="youtube-bgm" style="position: fixed; top: -200vh; left: -200vw; opacity: 0; pointer-events: none; z-index: -100;"></div>
    <div id="youtube-vocal" style="position: fixed; top: -200vh; left: -200vw; opacity: 0; pointer-events: none; z-index: -100;"></div>

    <!-- Start Overlay -->
    <div id="start-overlay" class="start-overlay">
        <canvas id="flame-canvas" class="flame-canvas"></canvas>
        <div class="start-content">
            <div id="cny-countdown" class="cny-countdown"></div>
            <div id="cny-label-top" class="cny-label"></div>

            <canvas class="horse-canvas" id="horse-canvas" aria-hidden="true"></canvas>

            <div id="cny-label-bottom" class="cny-label"></div>
            <div class="start-swipe-hint" id="start-swipe-hint">
                <span class="swipe-text-en">Enter for 10√ó Fortune</span>
            </div>
        </div>
        <div class="start-seal-row">
            <a
                class="start-seal-link start-seal-main"
                href="https://x1ao.art"
                target="_blank"
                rel="noopener noreferrer"
                aria-label="Visit x1ao.art"
            >
                <span class="seal-mat"></span>
                <img src="./image/xiao-seal.svg" alt="Xiao seal" class="start-seal-image" />
            </a>
            <a
                class="start-seal-link start-seal-main"
                href="https://jwjustinhuang.art"
                target="_blank"
                rel="noopener noreferrer"
                aria-label="Visit jwjustinhuang.art"
            >
                <span class="seal-mat seal-mat-white"></span>
                <img src="./image/artilor.webp" alt="Artilor" class="start-seal-image start-seal-round" />
            </a>
        </div>
    </div>

    <script type="module" src="./main.js"></script>
</body>
</html>

/* ============================================================
   Fortune Gacha — Styles
   ============================================================ */
* { margin: 0; padding: 0; box-sizing: border-box; }

body {
    background: #990000;
    overflow: hidden;
    width: 100vw;
    height: 100vh;
    font-family: 'Courier New', 'SF Mono', monospace;
    touch-action: pan-x pan-y;
    -ms-touch-action: pan-x pan-y;
}

/* ============ START OVERLAY ============ */
.flame-canvas {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 0;
}

.start-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: transparent;
    z-index: 9999;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
    transition: opacity 0.5s ease, visibility 0.5s ease;
}

.start-content {
    position: relative;
    z-index: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    gap: 1rem;
    width: 100%;
    height: 100%;
    padding: clamp(20px, 4vh, 50px) clamp(30px, 6vw, 60px);
    padding-top: 12vh;
    background: transparent;
    box-shadow: none;
    border-radius: 0;
    overflow: hidden;
}

@media (min-width: 768px) {
    .start-content {
        padding-top: 6vh;
        gap: 0.5rem;
    }
}

@media (min-width: 768px) and (orientation: landscape) {
    .start-content {
        padding-top: 4vh;
        gap: 0.25rem;
    }
}

/* Grand countdown blocks */
.cny-countdown {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: clamp(6px, 2vw, 12px);
    white-space: nowrap;
    position: relative;
    z-index: 2;
}

/* Horse character canvas */
.horse-canvas {
    position: absolute;
    top: 45%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: clamp(180px, 55vw, 500px);
    height: clamp(180px, 55vw, 500px);
    filter: drop-shadow(0 0 15px rgba(255, 165, 0, 0.6))
            drop-shadow(0 0 35px rgba(255, 69, 0, 0.3));
    animation: horseBreath 3s ease-in-out infinite;
    margin: 0;
    z-index: 1;
}

/* Desktop / landscape: constrain horse canvas to viewport height */
@media (min-width: 768px) {
    .horse-canvas {
        width: clamp(180px, 35vh, 400px);
        height: clamp(180px, 35vh, 400px);
        top: 48%;
    }
}

@keyframes horseBreath {
    0%, 100% { filter: drop-shadow(0 0 15px rgba(255, 165, 0, 0.6)) drop-shadow(0 0 35px rgba(255, 69, 0, 0.3)); }
    50% { filter: drop-shadow(0 0 25px rgba(255, 215, 0, 0.8)) drop-shadow(0 0 50px rgba(255, 69, 0, 0.5)); }
}

.countdown-unit {
    display: flex;
    flex-direction: column;
    align-items: center;
    min-width: clamp(48px, 14vw, 80px);
}

.countdown-number {
    font-family: 'Times New Roman', 'Georgia', serif;
    font-size: clamp(2.4rem, 10vw, 4.5rem);
    font-weight: 700;
    color: #FFD700;
    line-height: 1;
    text-shadow:
        0 0 30px rgba(255, 215, 0, 0.7),
        0 0 60px rgba(255, 69, 0, 0.4);
}

.countdown-label {
    font-family: 'Courier New', monospace;
    font-size: clamp(0.55rem, 1.8vw, 0.75rem);
    color: rgba(255, 215, 0, 0.7);
    letter-spacing: 2px;
    margin-top: 2px;
}

.countdown-separator {
    font-family: 'Times New Roman', serif;
    font-size: clamp(1.6rem, 6vw, 3rem);
    color: rgba(255, 215, 0, 0.5);
    line-height: 1;
    align-self: flex-start;
    padding-top: clamp(4px, 1.5vw, 10px);
}

/* Desktop: smaller countdown */
@media (min-width: 768px) {
    .countdown-number {
        font-size: clamp(2rem, 4vh, 3.2rem);
    }
    .countdown-separator {
        font-size: clamp(1.2rem, 3vh, 2rem);
        padding-top: clamp(2px, 0.8vh, 6px);
    }
    .countdown-label {
        font-size: clamp(0.5rem, 1vh, 0.65rem);
    }
    .countdown-unit {
        min-width: clamp(40px, 8vh, 70px);
    }
}

/* Label area */
.cny-label {
    color: #FFD700;
    text-align: center;
    text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
    position: relative;
    z-index: 2;
}

#cny-label-bottom {
    position: absolute;
    top: 66%;
    width: 100%;
    bottom: auto;
}

@media (orientation: landscape) {
    #cny-label-bottom {
        top: 72%;
    }
}

@media (min-width: 768px) {
    #cny-label-bottom {
        top: 70%;
    }
}

@media (min-width: 768px) and (orientation: landscape) {
    #cny-label-bottom {
        top: 74%;
    }
}

.cny-label-en {
    font-family: 'Courier New', monospace;
    font-size: clamp(0.8rem, 4vw, 1.6rem);
    letter-spacing: 3px;
    line-height: 1.5;
    margin-bottom: 10px;
    text-shadow: 0 0 16px rgba(255, 215, 0, 0.6), 0 0 6px rgba(255, 69, 0, 0.3);
}

.cny-label-highlight {
    color: #fff;
    white-space: nowrap;
    display: block;
    margin-top: 8px;
    text-shadow: 0 0 20px rgba(255, 100, 0, 0.8), 0 0 40px rgba(255, 69, 0, 0.5), 0 0 8px rgba(255, 215, 0, 0.9);
}

@media (min-width: 768px) {
    .cny-label-highlight {
        display: inline;
        margin-top: 0;
    }
}

.cny-label-cn {
    display: block;
    text-align: center;
}

.cny-label-char {
    font-family: 'Noto Serif TC', serif;
    font-size: clamp(1.6rem, 5.5vw, 2.4rem);
    font-weight: 700;
    display: block;
}

.cny-label-date {
    font-family: 'Courier New', monospace;
    font-size: clamp(0.8rem, 2.5vw, 1.1rem);
    opacity: 0.7;
    letter-spacing: 2px;
    display: block;
    margin-top: 4px;
}

/* Swipe-up hint on welcome page */
.start-swipe-hint {
    position: absolute;
    top: 76%;
    left: 0;
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    color: #FFD700;
    font-family: 'Courier New', monospace;
    text-shadow: 0 0 12px rgba(255, 215, 0, 0.5);
    animation: swipeHintPulse 2.5s ease-in-out infinite;
    cursor: pointer;
    user-select: none;
    margin: 0;
    z-index: 2;
}

@media (orientation: landscape) {
    .start-swipe-hint {
        top: 81%;
    }
}

@media (min-width: 768px) {
    .start-swipe-hint {
        top: 80%;
    }
}

@media (min-width: 768px) and (orientation: landscape) {
    .start-swipe-hint {
        top: 84%;
    }
}

.swipe-arrow {
    font-size: clamp(1.4rem, 5vw, 2rem);
    display: inline-flex;
    align-items: center;
    line-height: 1;
    vertical-align: middle;
    position: relative;
    top: -0.1em;
}

.swipe-text-en {
    font-size: clamp(1.0rem, 4vw, 1.3rem);
    letter-spacing: 3px;
    font-weight: bold;
}

.swipe-text-cn {
    display: none;
}

@keyframes swipeHintPulse {
    0%, 100% { opacity: 0.5; }
    50% { opacity: 1; }
}

@keyframes swipeHintHop {
    0%, 100% { transform: translateY(0); }
    15% { transform: translateY(-6px); }
    30% { transform: translateY(0); }
    45% { transform: translateY(-4px); }
    60% { transform: translateY(0); }
}



.start-seal-row {
    position: absolute;
    left: 50%;
    bottom: max(14.5vw, calc(14.5vw + env(safe-area-inset-bottom)));
    transform: translateX(-50%);
    display: flex;
    align-items: center;
    gap: 10px;
    z-index: 2;
}

.start-seal-link {
    width: clamp(28px, 5vw, 40px);
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0.88;
    transition: transform 0.25s ease, opacity 0.25s ease, filter 0.25s ease;
}

.start-seal-link:hover {
    opacity: 1;
    filter: drop-shadow(0 0 12px rgba(255, 215, 0, 0.25));
    transform: translateY(-2px) scale(1.03);
}

.start-seal-link:active {
    transform: scale(0.97);
}

.start-seal-image {
    display: block;
    width: 100%;
    height: auto;
    filter: drop-shadow(0 8px 18px rgba(0, 0, 0, 0.35));
}

.start-seal-round {
    border-radius: 50%;
    object-fit: cover;
    aspect-ratio: 1;
}

.start-ornament-top,
.start-ornament-bottom {
    display: none;
}


/* Desktop: seal avatars at very bottom */
@media (min-width: 768px) {
    .start-seal-row {
        bottom: 8px;
    }
}

.mute-btn {
    pointer-events: auto;
    position: static;
    flex-shrink: 0;
    width: 42px;
    height: 42px;
    border-radius: 50%;
    
    /* Clean Glassmorphism */
    background: rgba(255, 255, 255, 0.05);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border: 1px solid rgba(255, 255, 255, 0.15);
    
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    
    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    color: rgba(255, 215, 0, 0.9); /* Gold */
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    padding: 0;

    opacity: 0;
    transform: translateY(20px);
    visibility: hidden;
}

.mute-btn.visible {
    opacity: 1;
    transform: translateY(0);
    visibility: visible;
}

.mute-btn:hover {
    background: rgba(255, 215, 0, 0.15);
    border-color: rgba(255, 215, 0, 0.4);
    color: #FFD700;
    transform: translateY(-1px);
    box-shadow: 0 4px 15px rgba(255, 215, 0, 0.15);
}

.mute-btn:active {
    transform: translateY(0) scale(0.96);
}

.mute-btn .mute-icon {
    width: 22px;
    height: 22px;
    pointer-events: none;
}

.mute-btn .icon-muted {
    display: none;
}

.mute-btn.muted {
    border-color: rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 0.4);
    background: rgba(0, 0, 0, 0.2);
    box-shadow: none;
}
.mute-btn.muted:hover {
    color: rgba(255, 255, 255, 0.8);
    background: rgba(255, 255, 255, 0.1);
    border-color: rgba(255, 255, 255, 0.3);
}

.mute-btn.muted .icon-sound {
    display: none;
}
.mute-btn.muted .icon-muted {
    display: block;
}

canvas#c {
    display: block;
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    z-index: 0;
}

/* ============ BOTTOM CONTROLS ============ */
.bottom-controls {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 0 20px calc(20px + env(safe-area-inset-bottom)); /* Respect safe area */
    display: flex;
    justify-content: center;
    gap: 18px;
    align-items: center;
    z-index: 15;
    pointer-events: none; /* Let clicks pass through to canvas if not on buttons */
}

/* ============ MODE SWITCH TOGGLE ============ */
.mode-switch {
    pointer-events: auto;
    position: relative;
    display: flex;
    flex: 0 0 auto;
    min-width: 140px;
    background: rgba(0, 0, 0, 0.3);
    border: 1.5px solid rgba(255, 215, 0, 0.4);
    border-radius: 24px;
    padding: 4px;
    width: 140px;
    height: 48px;
    cursor: pointer;
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    transition: all 0.3s ease;
    opacity: 0;
    transform: translateY(20px);
    visibility: hidden;
}
.mode-switch.visible {
    opacity: 1;
    transform: translateY(0);
    visibility: visible;
}

.switch-track {
    position: absolute;
    top: 4px;
    bottom: 4px;
    left: 4px;
    width: calc(50% - 4px);
    background: linear-gradient(135deg, #FFD700, #FFA500);
    border-radius: 20px;
    transition: transform 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
    box-shadow: 0 0 12px rgba(255, 215, 0, 0.4);
    z-index: 1;
}
.mode-switch.multi .switch-track {
    transform: translateX(100%);
}

.switch-option {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 2;
    color: rgba(255, 215, 0, 0.6);
    font-size: 1.1rem;
    font-weight: bold;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    transition: color 0.3s;
    user-select: none;
}
.switch-option.active {
    color: #8B0000; /* Dark red for contrast on gold */
    text-shadow: none;
}
/* Ensure the inactive one stays gold */
.mode-switch.multi .switch-option[data-mode="single"] {
    color: rgba(255, 215, 0, 0.6);
}
.mode-switch.multi .switch-option[data-mode="multi"] {
    color: #8B0000;
}
.mode-switch:not(.multi) .switch-option[data-mode="single"] {
    color: #8B0000;
}

/* ============ COLLECTION FAB ============ */
.collection-fab {
    pointer-events: auto;
    position: static;
    width: auto;
    height: 48px;
    padding: 0 24px;
    border-radius: 30px;
    
    /* Frosted Glass Pill */
    background: linear-gradient(135deg,
        rgba(255, 255, 255, 0.12) 0%,
        rgba(255, 255, 255, 0.04) 100%);
    backdrop-filter: blur(16px) saturate(1.2);
    -webkit-backdrop-filter: blur(16px) saturate(1.2);

    border: 1px solid rgba(255, 255, 255, 0.18);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    
    color: #FFD700;
    font-size: 0.9rem;
    font-weight: 600;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    letter-spacing: 2px;
    text-transform: uppercase;
    cursor: pointer;
    
    display: flex;
    align-items: center;
    justify-content: center;
    
    transition: all 0.3s ease;
    opacity: 0;
    transform: translateY(20px);
    visibility: hidden;
    z-index: 20;
}

.collection-fab.visible {
    opacity: 1;
    transform: translateY(0);
    visibility: visible;
}

.collection-fab:hover {
    background: linear-gradient(135deg,
        rgba(255, 255, 255, 0.18) 0%,
        rgba(255, 255, 255, 0.08) 100%);
    border-color: rgba(255, 255, 255, 0.3);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
    transform: translateY(-2px);
}

.collection-fab:active {
    transform: translateY(1px);
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
}

@media (max-width: 520px) {
    .bottom-controls {
        gap: 10px;
        padding: 0 10px calc(16px + env(safe-area-inset-bottom));
    }
    .mode-switch {
        width: 120px;
        min-width: 120px;
        height: 44px;
    }
    .switch-option {
        font-size: 0.95rem;
    }
    .collection-fab {
        height: 44px;
        padding: 0 16px;
        font-size: 0.78rem;
        letter-spacing: 1px;
    }
}

/* ============ SHARED BUTTON STYLES ============ */
.btn-action {
    display: block;
    margin: 12px auto 0;
    padding: 12px 32px;
    background: rgba(255, 215, 0, 0.12);
    color: #FFD700;
    border: 1.5px solid rgba(255, 215, 0, 0.4);
    border-radius: 8px;
    font-size: 1rem;
    cursor: pointer;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    transition: all 0.3s ease;
    letter-spacing: 2px;
    text-shadow: 0 0 8px rgba(255, 215, 0, 0.3);
}
.btn-action:hover {
    background: rgba(255, 215, 0, 0.25);
    box-shadow: 0 0 20px rgba(255, 215, 0, 0.15);
    transform: translateY(-1px);
}
.btn-action.btn-secondary {
    background: transparent;
    border-color: rgba(255, 215, 0, 0.2);
    color: rgba(255, 215, 0, 0.5);
    font-size: 0.85rem;
}
.btn-action.btn-secondary:hover {
    color: rgba(255, 215, 0, 0.7);
    border-color: rgba(255, 215, 0, 0.4);
}

/* ============ MULTI-PULL OVERLAY ============ */
#multi-overlay {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    z-index: 30;
    display: none;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    background: rgba(20, 2, 2, 0.98);
    backdrop-filter: blur(30px);
    -webkit-backdrop-filter: blur(30px);
    overflow: hidden;
    padding: 16px 10px;
}
#multi-overlay.visible {
    display: flex;
    animation: overlayFadeIn 0.5s ease-out;
}
@keyframes overlayFadeIn {
    0% { opacity: 0; }
    100% { opacity: 1; }
}

.multi-title {
    font-size: 1.4rem;
    color: #FFD700;
    letter-spacing: 8px;
    margin-bottom: 20px;
    text-shadow: 0 0 12px rgba(255,215,0,0.4);
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
}

.multi-grid {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 12px;
    max-width: 750px;
    width: 92vw;
    margin: 0 auto;
}
@media (min-width: 600px) {
    .multi-grid { gap: 16px; width: 88vw; }
}

/* === CARD FLIP SYSTEM === */
.multi-card {
    position: relative;
    perspective: 800px;
    cursor: pointer;
    animation: mcSlideIn 0.4s ease-out both;
}
@keyframes mcSlideIn {
    0% { transform: translateY(30px) scale(0.8); opacity: 0; }
    100% { transform: translateY(0) scale(1); opacity: 1; }
}

.card-flipper {
    position: relative;
    width: 100%;
    aspect-ratio: 0.68;
    transition: transform 0.7s cubic-bezier(0.4, 0.0, 0.2, 1);
    transform-style: preserve-3d;
}
.multi-card.flipped .card-flipper {
    transform: rotateY(180deg);
}

/* Slow-motion flip for high rarity */
.multi-card.slow-flip-5 .card-flipper {
    transition: transform 1.3s cubic-bezier(0.16, 0.85, 0.45, 1);
}
.multi-card.slow-flip-6 .card-flipper {
    transition: transform 1.6s cubic-bezier(0.12, 0.9, 0.35, 1);
}
.multi-card.slow-flip-7 .card-flipper {
    transition: transform 2s cubic-bezier(0.08, 0.95, 0.3, 1);
}

/* Anticipation shake + glow buildup before flip */
.multi-card.anticipate-7 {
    z-index: 11;
}
.multi-card.anticipate-7 .card-flipper {
    animation: cardAnticipate7 1s ease-in-out forwards;
}
.multi-card.anticipate-7 .card-back {
    animation: glowBuild7 1s ease-in forwards;
}
.multi-card.anticipate-5 {
    z-index: 10;
}
.multi-card.anticipate-5 .card-flipper {
    animation: cardAnticipate5 0.5s ease-in-out forwards;
}
.multi-card.anticipate-5 .card-back {
    animation: glowBuild5 0.5s ease-in forwards;
}

.multi-card.anticipate-6 {
    z-index: 10;
}
.multi-card.anticipate-6 .card-flipper {
    animation: cardAnticipate6 0.7s ease-in-out forwards;
}
.multi-card.anticipate-6 .card-back {
    animation: glowBuild6 0.7s ease-in forwards;
}

@keyframes cardAnticipate5 {
    0%   { transform: scale(1); }
    20%  { transform: translateX(-3px) scale(1.04); }
    40%  { transform: translateX(3px) scale(1.05); }
    60%  { transform: translateX(-2px) scale(1.06); }
    80%  { transform: translateX(2px) scale(1.07); }
    100% { transform: translateY(-4px) scale(1.08); }
}
@keyframes cardAnticipate6 {
    0%   { transform: scale(1); }
    12%  { transform: translateY(-3px) scale(1.03); }
    25%  { transform: translateX(-4px) rotate(-1deg) scale(1.05); }
    38%  { transform: translateX(4px) rotate(1deg) scale(1.06); }
    50%  { transform: translateX(-3px) rotate(-0.8deg) scale(1.07); }
    62%  { transform: translateX(3px) rotate(0.8deg) scale(1.08); }
    75%  { transform: translateX(-2px) rotate(-0.5deg) scale(1.09); }
    88%  { transform: translateX(2px) rotate(0.5deg) scale(1.10); }
    100% { transform: translateY(-6px) scale(1.12); }
}
@keyframes glowBuild5 {
    0%   { box-shadow: 0 0 25px rgba(168,85,247,0.15), inset 0 0 30px rgba(0,0,0,0.3); }
    100% { box-shadow: 0 0 50px rgba(168,85,247,0.6), 0 0 80px rgba(168,85,247,0.3), inset 0 0 30px rgba(0,0,0,0.3); }
}
@keyframes glowBuild6 {
    0%   { box-shadow: 0 0 25px rgba(255,69,0,0.2), inset 0 0 30px rgba(0,0,0,0.3); }
    100% { box-shadow: 0 0 60px rgba(255,69,0,0.7), 0 0 100px rgba(255,150,0,0.4), inset 0 0 30px rgba(0,0,0,0.3); }
}
@keyframes cardAnticipate7 {
    0%   { transform: scale(1); }
    10%  { transform: translateY(-4px) scale(1.04); }
    20%  { transform: translateX(-5px) rotate(-1.5deg) scale(1.06); }
    30%  { transform: translateX(5px) rotate(1.5deg) scale(1.07); }
    40%  { transform: translateX(-4px) rotate(-1.2deg) scale(1.08); }
    50%  { transform: translateX(4px) rotate(1.2deg) scale(1.10); }
    60%  { transform: translateX(-3px) rotate(-1deg) scale(1.11); }
    70%  { transform: translateX(3px) rotate(1deg) scale(1.12); }
    80%  { transform: translateX(-2px) rotate(-0.5deg) scale(1.13); }
    90%  { transform: translateX(2px) rotate(0.5deg) scale(1.14); }
    100% { transform: translateY(-8px) scale(1.16); }
}
@keyframes glowBuild7 {
    0%   { box-shadow: 0 0 25px rgba(255,0,0,0.2), inset 0 0 30px rgba(0,0,0,0.3); }
    50%  { box-shadow: 0 0 80px rgba(255,0,0,0.6), 0 0 120px rgba(255,215,0,0.4), inset 0 0 30px rgba(0,0,0,0.3); }
    100% { box-shadow: 0 0 100px rgba(255,0,0,0.8), 0 0 150px rgba(255,215,0,0.5), 0 0 200px rgba(255,0,0,0.3), inset 0 0 30px rgba(0,0,0,0.3); }
}

.card-face {
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
    border-radius: 10px;
    overflow: hidden;
}

/* --- CARD BACK --- */
.card-back {
    background: linear-gradient(145deg, #8B0000, #4A0000 50%, #6B0000);
    border: 2px solid rgba(255, 215, 0, 0.5);
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow:
        0 0 20px rgba(255, 215, 0, 0.1),
        inset 0 0 30px rgba(0, 0, 0, 0.3);
}
.card-back-pattern {
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background:
        repeating-linear-gradient(45deg,
            transparent 0px, transparent 8px,
            rgba(255, 215, 0, 0.06) 8px, rgba(255, 215, 0, 0.06) 9px),
        repeating-linear-gradient(-45deg,
            transparent 0px, transparent 8px,
            rgba(255, 215, 0, 0.06) 8px, rgba(255, 215, 0, 0.06) 9px);
    pointer-events: none;
}
.card-back-fu {
    font-size: 2.2rem;
    color: rgba(255, 215, 0, 0.25);
    font-family: "Ma Shan Zheng", cursive;
    text-shadow: 0 0 20px rgba(255, 215, 0, 0.15);
    z-index: 2;
}
.card-back-border {
    position: absolute;
    top: 6px; left: 6px; right: 6px; bottom: 6px;
    border: 1px solid rgba(255, 215, 0, 0.2);
    border-radius: 6px;
    pointer-events: none;
}
/* Shimmer sweep on card back */
.card-back::after {
    content: '';
    position: absolute;
    top: -50%; left: -50%;
    width: 200%; height: 200%;
    background: linear-gradient(
        45deg,
        transparent 30%,
        rgba(255, 215, 0, 0.04) 45%,
        rgba(255, 215, 0, 0.08) 50%,
        rgba(255, 215, 0, 0.04) 55%,
        transparent 70%
    );
    animation: cardShimmer 3s ease-in-out infinite;
    pointer-events: none;
}
@keyframes cardShimmer {
    0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
    100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
}

/* High rarity card backs */
.multi-card[data-rarity="6"] .card-back {
    background: linear-gradient(145deg, #8B1500, #4A0800 50%, #7B1000);
    border-color: rgba(255, 69, 0, 0.7);
    box-shadow: 0 0 25px rgba(255, 69, 0, 0.2), inset 0 0 30px rgba(0, 0, 0, 0.3);
}
.multi-card[data-rarity="5"] .card-back {
    background: linear-gradient(145deg, #4A0060, #2A0040 50%, #3A0050);
    border-color: rgba(168, 85, 247, 0.6);
    box-shadow: 0 0 25px rgba(168, 85, 247, 0.15), inset 0 0 30px rgba(0, 0, 0, 0.3);
}

/* Unflipped card hover: gentle lift */
.multi-card:not(.flipped):hover .card-flipper {
    transform: translateY(-3px) scale(1.03);
}
.multi-card:not(.flipped):hover .card-back {
    box-shadow: 0 0 30px rgba(255, 215, 0, 0.2), inset 0 0 30px rgba(0, 0, 0, 0.3);
}

/* --- CARD FRONT --- */
.card-front {
    transform: rotateY(180deg);
    background: linear-gradient(160deg,
        rgba(30, 10, 10, 0.9),
        rgba(10, 5, 5, 0.97));
    border: 2px solid var(--mc-color, #FFD700);
    box-shadow:
        0 0 20px var(--mc-glow, rgba(255, 215, 0, 0.2)),
        inset 0 0 20px rgba(0, 0, 0, 0.3);
}
.card-front-inner {
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 8px 4px;
}
/* Corner decorations */
.card-front::before,
.card-front::after {
    content: '';
    position: absolute;
    width: 14px; height: 14px;
    border-color: var(--mc-color, #FFD700);
    border-style: solid;
    opacity: 0.4;
    z-index: 2;
}
.card-front::before { top: 5px; left: 5px; border-width: 1.5px 0 0 1.5px; }
.card-front::after { bottom: 5px; right: 5px; border-width: 0 1.5px 1.5px 0; }

/* Rarity glow behind card front */
.card-rarity-glow {
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background: radial-gradient(ellipse at center,
        var(--mc-glow, rgba(255, 215, 0, 0.1)),
        transparent 70%);
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.5s;
}
.multi-card.flipped .card-rarity-glow { opacity: 1; }

/* Flip burst light */
.multi-card.flipped .card-flipper::after {
    content: '';
    position: absolute;
    top: 50%; left: 50%;
    width: 120%; height: 120%;
    transform: translate(-50%, -50%);
    background: radial-gradient(circle,
        var(--mc-glow, rgba(255, 215, 0, 0.3)) 0%,
        transparent 70%);
    opacity: 0;
    animation: flipBurst 0.6s ease-out;
    pointer-events: none;
    z-index: 3;
}
@keyframes flipBurst {
    0% { opacity: 0.8; transform: translate(-50%, -50%) scale(0.5); }
    100% { opacity: 0; transform: translate(-50%, -50%) scale(1.5); }
}

/* === HIGH RARITY FLIP EFFECTS (5-star, 6-star) === */

/* 5-star: purple radiant burst */
.multi-card.flipped[data-rarity="5"] .card-flipper::after {
    width: 200%; height: 200%;
    background: radial-gradient(circle,
        rgba(168, 85, 247, 0.6) 0%,
        rgba(168, 85, 247, 0.2) 30%,
        transparent 70%);
    animation: flipBurstEpic 0.9s ease-out;
}

/* 6-star: orange-gold legendary burst */
.multi-card.flipped[data-rarity="6"] .card-flipper::after {
    width: 250%; height: 250%;
    background: radial-gradient(circle,
        rgba(255, 200, 50, 0.8) 0%,
        rgba(255, 69, 0, 0.4) 30%,
        rgba(255, 69, 0, 0.1) 50%,
        transparent 70%);
    animation: flipBurstLegendary 1.2s ease-out;
}

@keyframes flipBurstEpic {
    0% { opacity: 1; transform: translate(-50%, -50%) scale(0.3); }
    30% { opacity: 0.9; transform: translate(-50%, -50%) scale(1.0); }
    100% { opacity: 0; transform: translate(-50%, -50%) scale(2.0); }
}
@keyframes flipBurstLegendary {
    0% { opacity: 1; transform: translate(-50%, -50%) scale(0.2); }
    20% { opacity: 1; transform: translate(-50%, -50%) scale(0.8); }
    50% { opacity: 0.7; transform: translate(-50%, -50%) scale(1.2); }
    100% { opacity: 0; transform: translate(-50%, -50%) scale(2.5); }
}

/* High-rarity card front enhanced glow */
.multi-card.flipped[data-rarity="5"] .card-front {
    box-shadow:
        0 0 30px rgba(168, 85, 247, 0.5),
        0 0 60px rgba(168, 85, 247, 0.2),
        inset 0 0 20px rgba(0, 0, 0, 0.3);
}
.multi-card.flipped[data-rarity="6"] .card-front {
    box-shadow:
        0 0 30px rgba(255, 69, 0, 0.5),
        0 0 60px rgba(255, 69, 0, 0.25),
        0 0 100px rgba(255, 150, 0, 0.1),
        inset 0 0 20px rgba(0, 0, 0, 0.3);
}

/* Pulsing border for high rarity after reveal */
.multi-card.flipped[data-rarity="5"] .card-front {
    animation: rarityPulse5 2s ease-in-out 0.7s infinite;
}
.multi-card.flipped[data-rarity="6"] .card-front {
    animation: rarityPulse6 2s ease-in-out 0.7s infinite;
}
@keyframes rarityPulse5 {
    0%, 100% {
        box-shadow:
            0 0 32px rgba(168, 85, 247, 0.42),
            0 0 65px rgba(168, 85, 247, 0.17),
            inset 0 0 20px rgba(0, 0, 0, 0.3);
    }
    50% {
        box-shadow:
            0 0 38px rgba(168, 85, 247, 0.52),
            0 0 75px rgba(168, 85, 247, 0.22),
            inset 0 0 20px rgba(0, 0, 0, 0.3);
    }
}
@keyframes rarityPulse6 {
    0%, 100% {
        box-shadow:
            0 0 34px rgba(255, 69, 0, 0.52),
            0 0 70px rgba(255, 69, 0, 0.22),
            0 0 108px rgba(255, 150, 0, 0.08),
            inset 0 0 20px rgba(0, 0, 0, 0.3);
    }
    50% {
        box-shadow:
            0 0 42px rgba(255, 69, 0, 0.62),
            0 0 85px rgba(255, 69, 0, 0.28),
            0 0 125px rgba(255, 150, 0, 0.11),
            inset 0 0 20px rgba(0, 0, 0, 0.3);
    }
}

/* Screen flash overlay for legendary flips */
.multi-screen-flash {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    z-index: 35;
    pointer-events: none;
    opacity: 0;
}
.multi-screen-flash.flash-5 {
    background: radial-gradient(circle at center, rgba(168, 85, 247, 0.4), transparent 70%);
    animation: screenFlash 0.6s ease-out forwards;
}
.multi-screen-flash.flash-6 {
    background: radial-gradient(circle at center, rgba(255, 150, 0, 0.5), rgba(255, 69, 0, 0.2) 40%, transparent 70%);
    animation: screenFlash 0.8s ease-out forwards;
}
.multi-screen-flash.flash-7 {
    background: radial-gradient(circle at center, rgba(255, 0, 0, 0.7), rgba(255, 215, 0, 0.3) 40%, transparent 70%);
    animation: screenFlash 1s ease-out forwards;
}
@keyframes screenFlash {
    0% { opacity: 1; }
    100% { opacity: 0; }
}

/* Flipped card hover */
.multi-card.flipped:hover .card-flipper {
    transform: rotateY(180deg) translateY(-4px) scale(1.04);
}
/* Ensure slow-flip hover also transitions smoothly */
.multi-card.flipped.slow-flip-5:hover .card-flipper,
.multi-card.flipped.slow-flip-6:hover .card-flipper,
.multi-card.flipped.slow-flip-7:hover .card-flipper {
    transition: transform 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
    transform: rotateY(180deg) translateY(-4px) scale(1.04);
}
.multi-card.flipped:hover .card-front {
    box-shadow:
        0 0 35px var(--mc-glow, rgba(255, 215, 0, 0.4)),
        0 8px 25px rgba(0, 0, 0, 0.4),
        inset 0 0 20px rgba(0, 0, 0, 0.3);
}

/* --- CARD CONTENT --- */
.mc-stars {
    font-size: 0.5rem;
    color: var(--mc-color, #FFD700);
    letter-spacing: 1px;
    margin-bottom: 4px;
    text-shadow: 0 0 6px var(--mc-glow, rgba(255,215,0,0.4));
}
.mc-char {
    font-size: 2rem;
    color: #FFF;
    text-shadow:
        0 0 4px var(--mc-glow, rgba(255,215,0,0.8)),
        0 0 14px var(--mc-glow, rgba(255,215,0,0.5)),
        0 0 30px var(--mc-glow, rgba(255,215,0,0.3));
    line-height: 1.1;
    margin: 4px 0;
}
.multi-card.flipped .mc-char {
    animation: revealedCharBreathe 2.5s ease-in-out 0.7s infinite;
}
@keyframes revealedCharBreathe {
    0%, 100% {
        text-shadow:
            0 0 4px var(--mc-glow, rgba(255,215,0,0.8)),
            0 0 14px var(--mc-glow, rgba(255,215,0,0.5)),
            0 0 30px var(--mc-glow, rgba(255,215,0,0.3));
        transform: scale(1);
    }
    50% {
        text-shadow:
            0 0 5px var(--mc-glow, rgba(255,215,0,0.88)),
            0 0 17px var(--mc-glow, rgba(255,215,0,0.6)),
            0 0 34px var(--mc-glow, rgba(255,215,0,0.35));
        transform: scale(1.02);
    }
}
.mc-phrase {
    font-size: 0.38rem;
    color: var(--mc-color, #FFD700);
    opacity: 0.6;
    margin-top: 3px;
    letter-spacing: 1px;
}

@media (max-width: 520px) {
    .mc-char { font-size: 1.4rem; }
    .mc-stars { font-size: 0.35rem; }
    .mc-phrase { font-size: 0.3rem; }
    .card-back-fu { font-size: 1.6rem; }
}

/* --- HOVER TOOLTIP --- */
#multi-hover-tip {
    position: fixed;
    z-index: 40;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.2s;
    background: rgba(20, 4, 4, 0.92);
    border: 1px solid rgba(255, 215, 0, 0.4);
    border-radius: 8px;
    padding: 8px 12px;
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    max-width: 200px;
    text-align: center;
}
#multi-hover-tip .mht-category {
    font-size: 0.7rem;
    color: rgba(255,215,0,0.7);
    letter-spacing: 2px;
    margin-bottom: 4px;
}
#multi-hover-tip .mht-phrase {
    font-size: 0.9rem;
    color: #FFD700;
    margin-bottom: 2px;
    letter-spacing: 2px;
}
#multi-hover-tip .mht-english {
    font-size: 0.7rem;
    color: rgba(255,215,0,0.5);
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
}

.multi-actions {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-top: 16px;
}

/* ============ MULTI-FORTUNE FLOATING ACTIONS ============ */
.multi-fortune-actions {
    position: fixed;
    bottom: calc(24px + env(safe-area-inset-bottom));
    left: 50%;
    transform: translateX(-50%);
    z-index: 25;
    display: flex;
    flex-direction: row;
    flex-wrap: wrap;
    justify-content: center;
    align-items: center;
    gap: 12px;
    pointer-events: none;
    max-width: 92vw;
    width: 100%;
}

.multi-fortune-actions .btn-action {
    pointer-events: auto;
    height: 44px;
    padding: 0 20px;
    border-radius: 22px;
    font-size: 0.9rem;
    font-weight: 600;
    letter-spacing: 1px;
    text-transform: uppercase;
    
    display: flex;
    align-items: center;
    justify-content: center;
    
    /* Glassmorphism Base */
    background: rgba(20, 0, 0, 0.6);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border: 1px solid rgba(255, 215, 0, 0.3);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
    
    color: #FFD700;
    cursor: pointer;
    transition: all 0.25s cubic-bezier(0.4, 0.0, 0.2, 1);
}

.multi-fortune-actions .btn-action.btn-primary {
    background: linear-gradient(135deg,
        rgba(255, 255, 255, 0.12) 0%,
        rgba(255, 255, 255, 0.05) 50%,
        rgba(255, 215, 0, 0.08) 100%);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-top-color: rgba(255, 255, 255, 0.35);
    box-shadow:
        0 4px 24px rgba(0, 0, 0, 0.3),
        0 0 16px rgba(255, 215, 0, 0.08),
        inset 0 1px 0 rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(16px) saturate(1.4);
    -webkit-backdrop-filter: blur(16px) saturate(1.4);
    color: rgba(255, 255, 255, 0.9);
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    min-width: 140px;
    border-radius: 28px;
    padding: 0 28px;
    height: 48px;
}

.multi-fortune-actions .btn-action.btn-secondary {
    background: rgba(0, 0, 0, 0.5);
    border-color: rgba(255, 215, 0, 0.15);
    color: rgba(255, 215, 0, 0.7);
    font-size: 0.8rem;
}

.multi-fortune-actions .btn-action:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5), 0 0 15px rgba(255, 215, 0, 0.2);
}
.multi-fortune-actions .btn-action:active {
    transform: translateY(0);
}

.multi-fortune-actions .btn-action.btn-primary:hover {
    background: linear-gradient(135deg,
        rgba(255, 255, 255, 0.18) 0%,
        rgba(255, 255, 255, 0.08) 50%,
        rgba(255, 215, 0, 0.12) 100%);
    border-color: rgba(255, 255, 255, 0.35);
    box-shadow:
        0 8px 32px rgba(0, 0, 0, 0.4),
        0 0 20px rgba(255, 215, 0, 0.12),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
}

/* Reveal All: explicit frosted-glass variant */
.multi-fortune-actions #btn-reveal-all {
    background: linear-gradient(135deg,
        rgba(255, 255, 255, 0.14) 0%,
        rgba(255, 255, 255, 0.06) 48%,
        rgba(255, 215, 0, 0.1) 100%) !important;
    border: 1px solid rgba(255, 255, 255, 0.24) !important;
    border-top-color: rgba(255, 255, 255, 0.4) !important;
    color: rgba(255, 245, 220, 0.95) !important;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.28);
    box-shadow:
        0 6px 22px rgba(0, 0, 0, 0.32),
        0 0 14px rgba(255, 215, 0, 0.12),
        inset 0 1px 0 rgba(255, 255, 255, 0.2) !important;
    backdrop-filter: blur(16px) saturate(1.35) !important;
    -webkit-backdrop-filter: blur(16px) saturate(1.35) !important;
}

.multi-fortune-actions #btn-reveal-all:hover {
    background: linear-gradient(135deg,
        rgba(255, 255, 255, 0.2) 0%,
        rgba(255, 255, 255, 0.1) 48%,
        rgba(255, 215, 0, 0.14) 100%) !important;
    border-color: rgba(255, 255, 255, 0.36) !important;
    box-shadow:
        0 8px 28px rgba(0, 0, 0, 0.4),
        0 0 18px rgba(255, 215, 0, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.24) !important;
}

.multi-fortune-actions .btn-action.btn-secondary:hover {
    background: rgba(40, 0, 0, 0.6);
    border-color: rgba(255, 215, 0, 0.4);
    color: #FFD700;
}

/* ============ MULTI-PULL DETAIL POPUP ============ */
#multi-detail {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    z-index: 55;
    display: none;
    align-items: flex-start;
    justify-content: center;
    background: rgba(10, 2, 2, 0.6);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    cursor: pointer;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    padding: 24px 0;
}
#multi-detail.visible { display: flex; }

.detail-dialog {
    width: min(420px, 88vw);
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 20px;
    cursor: default;
    margin: auto 0;
    padding: 16px 0;
    flex-shrink: 0;
}

.detail-card {
    --orn-intensity: 0.4;
    --orn-corner-extra: 0;
    --orn-side: 0;
    --orn-cloud: 0;
    --orn-pulse: 0;

    width: 100%;
    padding: 60px 52px 52px;
    background: linear-gradient(155deg,
        rgba(70, 6, 6, 0.82) 0%,
        rgba(38, 5, 5, 0.85) 50%,
        rgba(55, 7, 7, 0.82) 100%);
    border: 1.5px solid rgba(255, 215, 0, 0.35);
    border-radius: 16px;
    box-shadow:
        0 0 24px var(--card-glow, rgba(255,215,0,0.15)),
        0 0 48px var(--card-glow, rgba(255,215,0,0.08)),
        inset 0 0 24px rgba(0,0,0,0.4);
    backdrop-filter: blur(16px) saturate(1.15);
    -webkit-backdrop-filter: blur(16px) saturate(1.15);
    text-align: center;
    animation: cardAppear 0.5s cubic-bezier(0.2, 0.9, 0.3, 1);
    position: relative;
    overflow: hidden;
}
.detail-card > :not(.detail-card-ornaments) {
    position: relative;
    z-index: 3;
}
@keyframes cardAppear {
    0% { transform: scale(0.3) rotateY(90deg); opacity: 0; }
    50% { transform: scale(1.05) rotateY(0deg); opacity: 1; }
    100% { transform: scale(1) rotateY(0deg); opacity: 1; }
}

/* Inner border ring 1 */
.detail-card::before {
    content: '';
    position: absolute;
    inset: 7px;
    border: 1.2px solid rgba(255, 215, 0, 0.25);
    border-radius: 12px;
    pointer-events: none;
    z-index: 1;
}
/* Inner border ring 2 (subtle, for 3+ stars) */
.detail-card::after {
    content: '';
    position: absolute;
    inset: 14px;
    border: 1px solid rgba(145, 22, 22, 0.35);
    border-radius: 9px;
    pointer-events: none;
    z-index: 1;
}

/* ===== SVG corner masks (回纹 designs) ===== */
/* Simple: L bracket with small notch */
/* Medium: L + 回纹 double hook + inner line */
/* Ornate: L + 回纹 triple hook + inner line + corner accent */

/* ===== Per-tier border system ===== */

.detail-card.stars-1 {
    --orn-intensity: 0.15; --orn-side: 0; --orn-cloud: 0; --orn-pulse: 0;
    --orn-color: rgba(176, 190, 197, 0.55);
    --orn-corner-size: 28px;
    --orn-corner-mask: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cpath d='M0 100V0h100' fill='none' stroke='white' stroke-width='5'/%3E%3C/svg%3E");
    border-color: rgba(176, 190, 197, 0.22);
}
.detail-card.stars-1::before { border-color: rgba(176, 190, 197, 0.1); }
.detail-card.stars-1::after { opacity: 0; }

.detail-card.stars-2 {
    --orn-intensity: 0.3; --orn-side: 0; --orn-cloud: 0; --orn-pulse: 0;
    --orn-color: rgba(176, 190, 197, 0.7);
    --orn-corner-size: 34px;
    --orn-corner-mask: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cpath d='M0 100V0h100' fill='none' stroke='white' stroke-width='5'/%3E%3Cpath d='M28 0v28H0' fill='none' stroke='white' stroke-width='4' opacity='.45'/%3E%3C/svg%3E");
    border-color: rgba(176, 190, 197, 0.32);
}
.detail-card.stars-2::before { border-color: rgba(176, 190, 197, 0.16); }
.detail-card.stars-2::after { opacity: 0; }

.detail-card.stars-3 {
    --orn-intensity: 0.55; --orn-side: 0; --orn-cloud: 0; --orn-pulse: 0;
    --orn-color: rgba(74, 222, 128, 0.8);
    --orn-corner-size: 42px;
    --orn-corner-mask: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cpath d='M0 100V0h100' fill='none' stroke='white' stroke-width='5'/%3E%3Cpath d='M26 0v26H0' fill='none' stroke='white' stroke-width='4'/%3E%3Cpath d='M0 50h50V0' fill='none' stroke='white' stroke-width='3' opacity='.55'/%3E%3C/svg%3E");
    border-color: rgba(74, 222, 128, 0.3);
}
.detail-card.stars-3::before { border-color: rgba(74, 222, 128, 0.18); }
.detail-card.stars-3::after { border-color: rgba(74, 222, 128, 0.08); }

.detail-card.stars-4 {
    --orn-intensity: 0.72; --orn-side: 0.85; --orn-cloud: 0; --orn-pulse: 0;
    --orn-color: rgba(77, 166, 255, 0.88);
    --orn-corner-size: 44px;
    --orn-corner-mask: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cpath d='M0 100V0h100' fill='none' stroke='white' stroke-width='5'/%3E%3Cpath d='M26 0v26H0' fill='none' stroke='white' stroke-width='4'/%3E%3Cpath d='M0 50h50V0' fill='none' stroke='white' stroke-width='3' opacity='.65'/%3E%3Cpath d='M10 88V10h78' fill='none' stroke='white' stroke-width='2' opacity='.25'/%3E%3C/svg%3E");
    border-color: rgba(77, 166, 255, 0.38);
    box-shadow:
        0 0 28px rgba(77, 166, 255, 0.15),
        0 0 56px rgba(77, 166, 255, 0.08),
        inset 0 0 24px rgba(0,0,0,0.4);
}
.detail-card.stars-4::before { border-color: rgba(77, 166, 255, 0.22); }
.detail-card.stars-4::after { border-color: rgba(77, 166, 255, 0.1); }

.detail-card.stars-5 {
    --orn-intensity: 0.88; --orn-side: 0.92; --orn-cloud: 0.88; --orn-pulse: 0.15;
    --orn-color: rgba(176, 112, 255, 0.92);
    --orn-corner-size: 48px;
    --orn-corner-mask: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cpath d='M0 100V0h100' fill='none' stroke='white' stroke-width='5'/%3E%3Cpath d='M24 0v24H0' fill='none' stroke='white' stroke-width='4'/%3E%3Cpath d='M0 44h44V0' fill='none' stroke='white' stroke-width='3.5' opacity='.7'/%3E%3Cpath d='M62 0v62H0' fill='none' stroke='white' stroke-width='3' opacity='.45'/%3E%3Cpath d='M10 86V10h76' fill='none' stroke='white' stroke-width='2' opacity='.28'/%3E%3Crect x='5' y='5' width='7' height='7' rx='1.5' fill='white' opacity='.5'/%3E%3C/svg%3E");
    border-color: rgba(176, 112, 255, 0.42);
    box-shadow:
        0 0 32px rgba(176, 112, 255, 0.2),
        0 0 64px rgba(176, 112, 255, 0.1),
        inset 0 0 24px rgba(0,0,0,0.4);
}
.detail-card.stars-5::before { border-color: rgba(176, 112, 255, 0.26); }
.detail-card.stars-5::after { border-color: rgba(176, 112, 255, 0.12); }

.detail-card.stars-6 {
    --orn-intensity: 1; --orn-side: 1; --orn-cloud: 1; --orn-pulse: 1;
    --orn-color: rgba(255, 215, 0, 0.95);
    --orn-corner-size: 52px;
    --orn-corner-mask: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cpath d='M0 100V0h100' fill='none' stroke='white' stroke-width='6'/%3E%3Cpath d='M22 0v22H0' fill='none' stroke='white' stroke-width='4.5'/%3E%3Cpath d='M0 42h42V0' fill='none' stroke='white' stroke-width='3.5' opacity='.8'/%3E%3Cpath d='M60 0v60H0' fill='none' stroke='white' stroke-width='3' opacity='.55'/%3E%3Cpath d='M76 0v76H0' fill='none' stroke='white' stroke-width='2.5' opacity='.35'/%3E%3Cpath d='M10 86V10h76' fill='none' stroke='white' stroke-width='2' opacity='.3'/%3E%3Crect x='5' y='5' width='8' height='8' rx='2' fill='white' opacity='.6'/%3E%3Ccircle cx='50' cy='3' r='2' fill='white' opacity='.5'/%3E%3Ccircle cx='3' cy='50' r='2' fill='white' opacity='.5'/%3E%3C/svg%3E");
    border-color: rgba(255, 215, 0, 0.6);
    box-shadow:
        0 0 36px rgba(255, 69, 0, 0.25),
        0 0 72px rgba(255, 215, 0, 0.15),
        inset 0 0 24px rgba(0,0,0,0.4);
}

.detail-card.stars-6::before {
    border-color: rgba(255, 215, 0, 0.4);
    animation: detailImperialRing 2.3s ease-in-out infinite;
}
.detail-card.stars-6::after { border-color: rgba(255, 69, 0, 0.2); }

@keyframes detailImperialRing {
    0%, 100% {
        box-shadow: 0 0 8px rgba(255, 220, 145, 0.08), inset 0 0 4px rgba(255, 220, 145, 0.05);
        border-color: rgba(255, 215, 0, 0.45);
    }
    50% {
        box-shadow: 0 0 20px rgba(255, 220, 145, 0.22), inset 0 0 8px rgba(255, 220, 145, 0.14);
        border-color: rgba(255, 235, 175, 0.65);
    }
}

/* ===== 7-STAR: 五福临门 — Ultimate Legendary ===== */
.detail-card.stars-7 {
    --orn-intensity: 1; --orn-side: 1; --orn-cloud: 1; --orn-pulse: 1;
    --orn-color: rgba(255, 0, 0, 1);
    --orn-corner-size: 56px;
    --orn-corner-mask: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cpath d='M0 100V0h100' fill='none' stroke='white' stroke-width='7'/%3E%3Cpath d='M20 0v20H0' fill='none' stroke='white' stroke-width='5'/%3E%3Cpath d='M0 38h38V0' fill='none' stroke='white' stroke-width='4' opacity='.9'/%3E%3Cpath d='M55 0v55H0' fill='none' stroke='white' stroke-width='3.5' opacity='.7'/%3E%3Cpath d='M70 0v70H0' fill='none' stroke='white' stroke-width='3' opacity='.5'/%3E%3Cpath d='M85 0v85H0' fill='none' stroke='white' stroke-width='2.5' opacity='.35'/%3E%3Cpath d='M10 90V10h80' fill='none' stroke='white' stroke-width='2' opacity='.4'/%3E%3Crect x='4' y='4' width='10' height='10' rx='2' fill='white' opacity='.7'/%3E%3Ccircle cx='50' cy='3' r='3' fill='white' opacity='.6'/%3E%3Ccircle cx='3' cy='50' r='3' fill='white' opacity='.6'/%3E%3Ccircle cx='75' cy='3' r='2' fill='white' opacity='.4'/%3E%3Ccircle cx='3' cy='75' r='2' fill='white' opacity='.4'/%3E%3C/svg%3E");
    border-color: rgba(255, 0, 0, 0.8);
    box-shadow:
        0 0 50px rgba(255, 0, 0, 0.4),
        0 0 100px rgba(255, 215, 0, 0.25),
        0 0 150px rgba(255, 0, 0, 0.15),
        inset 0 0 30px rgba(0, 0, 0, 0.3);
    animation: cardAppear 0.5s cubic-bezier(0.2, 0.9, 0.3, 1), stars7InnerGlow 5s ease-in-out infinite;
}
@keyframes stars7InnerGlow {
    0%, 100% {
        box-shadow:
            0 0 50px rgba(255, 0, 0, 0.4),
            0 0 100px rgba(255, 215, 0, 0.25),
            0 0 150px rgba(255, 0, 0, 0.15),
            inset 0 0 30px rgba(0, 0, 0, 0.3);
    }
    50% {
        box-shadow:
            0 0 50px rgba(255, 0, 0, 0.4),
            0 0 100px rgba(255, 215, 0, 0.25),
            0 0 150px rgba(255, 0, 0, 0.15),
            inset 0 0 50px rgba(100, 10, 0, 0.18);
    }
}
.detail-card.stars-7::before {
    border-color: rgba(255, 0, 0, 0.6);
    animation: stars7Ring 3.5s ease-in-out infinite;
}
.detail-card.stars-7::after {
    border-color: rgba(255, 215, 0, 0.35);
    animation: stars7Ring 3.5s ease-in-out 1.75s infinite;
}
@keyframes stars7Ring {
    0%, 100% {
        box-shadow: 0 0 12px rgba(255, 20, 0, 0.12), inset 0 0 4px rgba(255, 60, 0, 0.05);
        border-color: rgba(255, 20, 0, 0.45);
    }
    50% {
        box-shadow: 0 0 16px rgba(255, 30, 0, 0.18), inset 0 0 6px rgba(255, 80, 0, 0.08);
        border-color: rgba(255, 40, 0, 0.55);
    }
}
/* Radiating glow overlay for 7-star */
.detail-card.stars-7 .detail-card-ornaments::before {
    content: '';
    position: absolute;
    inset: -20px;
    border-radius: 24px;
    background: radial-gradient(ellipse at center, rgba(255, 0, 0, 0.12) 0%, transparent 70%);
    animation: stars7Radiate 4s ease-in-out infinite;
    pointer-events: none;
}
@keyframes stars7Radiate {
    0%, 100% { opacity: 0.6; transform: scale(1); }
    50% { opacity: 0.7; transform: scale(1.01); }
}
/* Golden sparkle particles for 7-star */
.detail-card.stars-7 .detail-card-ornaments::after {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: 16px;
    background-image:
        radial-gradient(2px 2px at 15% 20%, rgba(255, 215, 0, 0.9) 50%, transparent 100%),
        radial-gradient(2px 2px at 85% 15%, rgba(255, 255, 200, 0.8) 50%, transparent 100%),
        radial-gradient(1.5px 1.5px at 25% 80%, rgba(255, 200, 0, 0.7) 50%, transparent 100%),
        radial-gradient(2px 2px at 75% 75%, rgba(255, 215, 0, 0.9) 50%, transparent 100%),
        radial-gradient(1.5px 1.5px at 50% 50%, rgba(255, 255, 200, 0.6) 50%, transparent 100%),
        radial-gradient(2px 2px at 10% 55%, rgba(255, 200, 0, 0.8) 50%, transparent 100%),
        radial-gradient(1.5px 1.5px at 90% 45%, rgba(255, 215, 0, 0.7) 50%, transparent 100%),
        radial-gradient(2px 2px at 40% 10%, rgba(255, 255, 200, 0.8) 50%, transparent 100%);
    animation: stars7Sparkle 6s ease-in-out infinite;
    pointer-events: none;
}
@keyframes stars7Sparkle {
    0%, 100% { opacity: 0.6; }
    25% { opacity: 0.68; }
    50% { opacity: 0.62; }
    75% { opacity: 0.72; }
}
/* 7-star text color — text-shadow inherited from .detail-character using var(--card-glow) */
.detail-card.stars-7 .detail-character {
    color: #FF0000;
}
.detail-card.stars-7 .detail-char-en,
.detail-card.stars-7 .detail-english {
    color: #FFD700;
    text-shadow:
        0 0 15px rgba(255, 215, 0, 0.8),
        0 0 30px rgba(255, 0, 0, 0.4);
}

.detail-card-ornaments {
    position: absolute;
    inset: 0;
    pointer-events: none;
    z-index: 2;
    border-radius: 16px;
}

.detail-card.stars-7 .detail-card-ornaments {
    animation: stars7SurfaceGlow 5s ease-in-out infinite;
}
@keyframes stars7SurfaceGlow {
    0%, 100% { background-color: rgba(140, 10, 0, 0.03); }
    50% { background-color: rgba(140, 10, 0, 0.35); }
}

/* ===== Corner ornaments (SVG mask + background-color) ===== */
.orn-corner {
    position: absolute;
    width: var(--orn-corner-size, 40px);
    height: var(--orn-corner-size, 40px);
    background-color: var(--orn-color, rgba(255, 215, 0, 0.8));
    -webkit-mask-image: var(--orn-corner-mask);
    mask-image: var(--orn-corner-mask);
    -webkit-mask-size: contain;
    mask-size: contain;
    -webkit-mask-repeat: no-repeat;
    mask-repeat: no-repeat;
    opacity: calc(0.55 + var(--orn-intensity) * 0.45);
    filter: drop-shadow(0 0 6px var(--orn-color, rgba(255, 215, 0, 0.3)));
}
.orn-corner::before, .orn-corner::after { content: none; }
.orn-tl { top: 6px; left: 6px; }
.orn-tr { top: 6px; right: 6px; transform: scaleX(-1); }
.orn-bl { bottom: 6px; left: 6px; transform: scaleY(-1); }
.orn-br { bottom: 6px; right: 6px; transform: scale(-1, -1); }

/* ===== Top/bottom center bar ===== */
.orn-center {
    position: absolute;
    left: 50%;
    width: min(160px, 42%);
    height: 10px;
    transform: translateX(-50%);
    opacity: calc(0.6 + var(--orn-intensity) * 0.3);
}
.orn-center::before,
.orn-center::after {
    content: '';
    position: absolute;
    left: 0;
    right: 0;
}
/* Main horizontal line with center gap */
.orn-center::before {
    top: 0;
    height: 1.6px;
    background: linear-gradient(90deg,
        var(--orn-color, rgba(255, 215, 0, 0.9)) 0 30%,
        transparent 30% 70%,
        var(--orn-color, rgba(255, 215, 0, 0.9)) 70% 100%);
}
/* Inner accent marks */
.orn-center::after {
    top: 0;
    left: 18%;
    right: 18%;
    height: 8px;
    background: linear-gradient(90deg,
        var(--orn-color, rgba(255, 215, 0, 0.9)) 0 6%,
        transparent 6% 94%,
        var(--orn-color, rgba(255, 215, 0, 0.9)) 94% 100%);
}
.orn-top { top: 14px; }
.orn-bottom { bottom: 14px; transform: translateX(-50%) scaleY(-1); }

/* ===== Side ornaments ===== */
.orn-side {
    position: absolute;
    top: 50%;
    width: 10px;
    height: 60px;
    transform: translateY(-50%);
    opacity: calc(var(--orn-side) * 0.96);
}
.orn-side::before,
.orn-side::after {
    content: '';
    position: absolute;
}
/* Vertical line with center gap */
.orn-side::before {
    left: 50%;
    top: 0;
    width: 1.6px;
    height: 100%;
    transform: translateX(-50%);
    background: linear-gradient(180deg,
        var(--orn-color, rgba(255, 215, 0, 0.86)) 0 30%,
        transparent 30% 70%,
        var(--orn-color, rgba(255, 215, 0, 0.86)) 70% 100%);
}
/* Horizontal tick mark */
.orn-side::after {
    top: 50%;
    width: 8px;
    height: 1.6px;
    transform: translateY(-50%);
    background: var(--orn-color, rgba(255, 215, 0, 0.88));
}
.orn-left { left: 14px; }
.orn-left::after { left: 1px; }
.orn-right { right: 14px; }
.orn-right::after { right: 1px; }

/* ===== Cloud flourish (祥云) ===== */
.orn-cloud {
    position: absolute;
    left: 50%;
    width: min(140px, 36%);
    height: 16px;
    transform: translateX(-50%);
    opacity: calc(var(--orn-cloud) * 0.92);
}
.orn-cloud::before,
.orn-cloud::after {
    content: '';
    position: absolute;
    left: 0;
    right: 0;
    border-top: 1.6px solid var(--orn-color, rgba(255, 220, 145, 0.9));
    border-radius: 999px;
}
.orn-cloud::before {
    top: 7px;
}
.orn-cloud::after {
    left: 22%;
    right: 22%;
    top: 1px;
}
.orn-cloud-top { top: 30px; }
.orn-cloud-bottom { bottom: 30px; transform: translateX(-50%) scaleY(-1); }

/* ===== Corner dot accents ===== */
.orn-seal-dots {
    position: absolute;
    inset: 0;
    opacity: calc(var(--orn-pulse) * 0.95);
    background:
        radial-gradient(circle at 24% 10%, var(--orn-color, rgba(255, 228, 150, 0.96)) 0 2.2px, transparent 3px),
        radial-gradient(circle at 76% 10%, var(--orn-color, rgba(255, 228, 150, 0.96)) 0 2.2px, transparent 3px),
        radial-gradient(circle at 24% 90%, var(--orn-color, rgba(255, 228, 150, 0.96)) 0 2.2px, transparent 3px),
        radial-gradient(circle at 76% 90%, var(--orn-color, rgba(255, 228, 150, 0.96)) 0 2.2px, transparent 3px);
    animation: detailSealPulse 4s ease-in-out infinite;
}

@keyframes detailSealPulse {
    0%, 100% { opacity: calc(var(--orn-pulse) * 0.85); }
    50% { opacity: calc(var(--orn-pulse) * 0.95); }
}

.detail-category {
    font-size: 0.95rem;
    color: var(--card-color, #FFD700);
    margin-bottom: 6px;
    letter-spacing: 5px;
    line-height: 1.6;
    text-shadow: 0 0 8px var(--card-glow, rgba(255,215,0,0.3));
}
.detail-category-en {
    font-size: 0.75rem;
    letter-spacing: 2px;
    opacity: 0.7;
}
.detail-stars {
    font-size: 1.4rem;
    letter-spacing: 4px;
    margin-bottom: 12px;
    color: var(--card-color, #FFD700);
    text-shadow: 0 0 10px var(--card-glow, rgba(255,215,0,0.5));
}
.detail-character {
    font-family: "Ma Shan Zheng", "ZCOOL XiaoWei", serif;
    font-size: 7.5rem;
    line-height: 1;
    color: #FFD700;
    text-shadow:
        0 0 5px var(--card-glow, rgba(255,225,100,0.9)),
        0 0 16px var(--card-glow, rgba(255,215,0,0.6)),
        0 0 36px var(--card-glow, rgba(255,200,50,0.3)),
        0 0 65px var(--card-glow, rgba(255,180,0,0.15));
    margin: 16px 0 12px;
    animation: detailCharAppear 0.5s ease-out both,
               detailCharBreathe 3.5s ease-in-out 0.5s infinite;
}

@keyframes detailCharAppear {
    0%   { opacity: 0; transform: scale(0.4) rotateY(60deg); }
    50%  { opacity: 1; transform: scale(1.06) rotateY(-5deg); }
    100% { opacity: 1; transform: scale(1) rotateY(0deg); }
}

@keyframes detailCharBreathe {
    0%, 100% {
        text-shadow:
            0 0 5px var(--card-glow, rgba(255,225,100,0.9)),
            0 0 16px var(--card-glow, rgba(255,215,0,0.6)),
            0 0 36px var(--card-glow, rgba(255,200,50,0.3)),
            0 0 65px var(--card-glow, rgba(255,180,0,0.15));
        transform: scale(1);
    }
    50% {
        text-shadow:
            0 0 6px var(--card-glow, rgba(255,230,115,0.92)),
            0 0 19px var(--card-glow, rgba(255,215,0,0.65)),
            0 0 40px var(--card-glow, rgba(255,200,50,0.35)),
            0 0 72px var(--card-glow, rgba(255,180,0,0.18));
        transform: scale(1.012);
    }
}
.detail-divider {
    width: 50%;
    height: 1px;
    margin: 0 auto 20px;
    background: linear-gradient(90deg, transparent, var(--card-color, #FFD700), transparent);
    opacity: 0.5;
}
/* --- Bilingual secondary text (Chinese subtitle in buttons/headers) --- */
.btn-zh {
    font-size: 0.7em;
    opacity: 0.55;
    margin-left: 4px;
    font-weight: normal;
    letter-spacing: 1px;
}
.header-zh {
    font-size: 0.5em;
    opacity: 0.45;
    margin-left: 8px;
    font-weight: 300;
    letter-spacing: 2px;
}

/* --- Enhanced detail card sections --- */
.detail-char-en {
    font-size: 1.4rem;
    color: #FFD700;
    font-family: 'Roboto Slab', serif;
    font-weight: 600;
    letter-spacing: 3px;
    text-transform: uppercase;
    margin-top: 4px;
    margin-bottom: 20px;
    text-shadow: 0 0 12px var(--card-glow, rgba(255,215,0,0.5));
}
@keyframes speakPulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.2); }
}

.detail-idiom-section {
    margin-bottom: 12px;
}
.detail-idiom-label,
.detail-meaning-label {
    font-size: 0.65rem;
    color: rgba(255, 215, 0, 0.35);
    letter-spacing: 3px;
    text-transform: uppercase;
    margin-bottom: 6px;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
}
.detail-phrase-row {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    margin-bottom: 6px;
}
.detail-phrase {
    font-size: 1.3rem;
    color: var(--card-color, #FFD700);
    opacity: 0.6;
    letter-spacing: 8px;
    margin-bottom: 6px;
}
.speak-btn {
    background: none;
    border: 1px solid rgba(255, 215, 0, 0.25);
    border-radius: 50%;
    width: 30px;
    height: 30px;
    font-size: 0.9rem;
    cursor: pointer;
    color: rgba(255, 215, 0, 0.6);
    transition: all 0.2s;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0;
}
.speak-btn:hover, .speak-btn:active {
    color: #FFD700;
    border-color: rgba(255, 215, 0, 0.6);
    background: rgba(255, 215, 0, 0.1);
}
.speak-btn.playing {
    color: #FFD700;
    border-color: #FFD700;
    animation: speakPulse 0.6s ease-in-out infinite;
}
.detail-english {
    font-size: 1rem;
    color: #FFD700;
    font-family: 'Roboto Slab', serif;
    font-weight: 500;
    letter-spacing: 2px;
    margin-bottom: 8px;
    font-style: italic;
    text-shadow: 0 0 10px var(--card-glow, rgba(255,215,0,0.3));
}
.detail-meaning-section {
    margin-top: 8px;
    padding-top: 8px;
    border-top: 1px solid rgba(255, 215, 0, 0.1);
}
.detail-meaning {
    font-size: 0.8rem;
    color: rgba(255, 255, 255, 0.6);
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    line-height: 1.5;
    letter-spacing: 0.5px;
}
@media (max-width: 520px) {
    #multi-detail {
        padding: 12px 0;
    }
    .detail-dialog {
        width: min(94vw, 420px);
        gap: 16px;
        padding: 8px 0;
    }
    .detail-card {
        padding: 56px 40px 44px;
    }
    .detail-character {
        font-size: 5.5rem;
        margin: 12px 0 10px;
    }
    .detail-phrase {
        font-size: 1.1rem;
        letter-spacing: 5px;
    }
    .detail-char-en {
        font-size: 1.15rem;
    }
    .detail-meaning {
        font-size: 0.72rem;
    }
    .btn-detail-action {
        min-width: 82px;
        padding: 9px 14px;
        font-size: 11px;
    }
    .btn-detail-pronunciation {
        max-width: 180px;
    }
}
@media (max-height: 650px) {
    .detail-character {
        font-size: 5rem;
        margin: 8px 0 8px;
    }
    .detail-card {
        padding: 48px 36px 40px;
    }
    .detail-stars {
        font-size: 1.1rem;
        margin-bottom: 6px;
    }
    .detail-phrase {
        font-size: 1rem;
    }
}
@media (max-width: 420px) {
    .collection-hero-row {
        gap: 16px;
    }
    .collection-progress-center,
    .collection-progress-half {
        gap: 10px;
    }
    .progress-ring-wrap {
        width: 56px;
        height: 56px;
    }
    .progress-pct {
        font-size: 1.1rem;
    }
    .stat-row-value {
        font-size: 1.1rem;
    }
    .collection-title-main {
        font-size: 1.2rem;
        letter-spacing: 4px;
    }
    .collection-title-sub {
        letter-spacing: 4px;
        font-size: 0.55rem;
    }
    .collection-title-cn {
        font-size: 0.75rem;
    }
    .collection-pill-btn {
        height: 34px;
        padding: 0 16px;
        font-size: 10px;
        letter-spacing: 2px;
    }
}

/* ============ COLLECTION PANEL ============ */
#collection-panel {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    z-index: 50;
    display: none;
    flex-direction: column;
    background: linear-gradient(160deg,
        rgba(55, 8, 8, 0.82) 0%,
        rgba(25, 4, 4, 0.78) 50%,
        rgba(35, 6, 6, 0.82) 100%);
    backdrop-filter: blur(36px) saturate(1.4);
    -webkit-backdrop-filter: blur(36px) saturate(1.4);
}
#collection-panel.visible {
    display: flex;
    animation: collectionOpen 0.5s cubic-bezier(0.2, 0.9, 0.3, 1);
}
@keyframes collectionOpen {
    0% { opacity: 0; transform: scale(0.96); }
    100% { opacity: 1; transform: scale(1); }
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

.collection-header {
    flex-shrink: 0;
    padding: 36px 24px 28px;
    background: linear-gradient(to bottom,
        rgba(255, 255, 255, 0.05) 0%,
        rgba(255, 215, 0, 0.012) 50%,
        transparent 100%);
    border-bottom: 1px solid rgba(255, 215, 0, 0.08);
    display: flex;
    flex-direction: column;
    align-items: center;
    position: relative;
    z-index: 2;
}

/* --- Hero row: title left, progress right --- */
.collection-hero-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    max-width: 560px;
    gap: 24px;
}

/* --- Title block (left-aligned) --- */
.collection-title-en {
    margin: 0;
    text-align: left;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    line-height: 1;
    flex-shrink: 0;
}
.collection-title-main {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    font-size: 1.6rem;
    font-weight: 700;
    letter-spacing: 7px;
    background: linear-gradient(135deg, #FFD700 0%, #FFF1BE 40%, #FFD700 80%);
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
    background-size: 200% 100%;
    animation: titleShimmer 4s ease-in-out infinite;
}
@keyframes titleShimmer {
    0%, 100% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
}
.collection-title-sub {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    font-size: 0.6rem;
    font-weight: 500;
    letter-spacing: 7px;
    color: rgba(255, 215, 0, 0.3);
    -webkit-text-fill-color: rgba(255, 215, 0, 0.3);
    margin-top: 5px;
}
.collection-title-cn {
    font-family: "Ma Shan Zheng", cursive;
    font-size: 0.85rem;
    letter-spacing: 3px;
    color: rgba(255, 215, 0, 0.2);
    -webkit-text-fill-color: rgba(255, 215, 0, 0.2);
    font-weight: normal;
    margin-top: 8px;
}

/* --- Collection Progress (right half of status row) --- */

/* SVG Ring Container */
.progress-ring-wrap {
    position: relative;
    width: 72px;
    height: 72px;
    flex-shrink: 0;
}
.progress-ring-wrap svg {
    width: 100%;
    height: 100%;
    transform: rotate(-90deg);
}
.progress-ring-bg {
    fill: none;
    stroke: rgba(255, 255, 255, 0.06);
    stroke-width: 5;
}
.progress-ring-fill {
    fill: none;
    stroke: url(#progressGradient);
    stroke-width: 5;
    stroke-linecap: round;
    transition: stroke-dashoffset 1.2s cubic-bezier(0.4, 0, 0.2, 1);
    filter: drop-shadow(0 0 6px rgba(255, 215, 0, 0.35));
}
.progress-ring-glow {
    fill: none;
    stroke: rgba(255, 215, 0, 0.12);
    stroke-width: 10;
    stroke-linecap: round;
    transition: stroke-dashoffset 1.2s cubic-bezier(0.4, 0, 0.2, 1);
    filter: blur(3px);
}
.progress-ring-center {
    position: absolute;
    inset: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}
.progress-pct {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    font-size: 1.35rem;
    font-weight: 700;
    color: #FFD700;
    line-height: 1;
    text-shadow: 0 0 14px rgba(255, 215, 0, 0.35);
}
.progress-pct-sign {
    font-size: 0.65rem;
    font-weight: 500;
    opacity: 0.6;
}
.progress-label {
    font-size: 0.5rem;
    color: rgba(255, 255, 255, 0.3);
    text-transform: uppercase;
    letter-spacing: 1.8px;
    margin-top: 2px;
}

/* Side Stats (Collected / Total) */
.progress-stats {
    display: flex;
    flex-direction: column;
    gap: 14px;
}
.stat-row {
    display: flex;
    align-items: baseline;
    gap: 8px;
}
.stat-row-value {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    font-size: 1.5rem;
    font-weight: 700;
    color: #FFD700;
    line-height: 1;
    text-shadow: 0 0 10px rgba(255, 215, 0, 0.2);
    min-width: 36px;
}
.stat-row-divider {
    font-size: 0.9rem;
    color: rgba(255, 215, 0, 0.25);
    font-weight: 300;
}
.stat-row-total {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    font-size: 0.95rem;
    color: rgba(255, 215, 0, 0.4);
    font-weight: 500;
}
.stat-row-label {
    font-size: 0.58rem;
    color: rgba(255, 255, 255, 0.25);
    text-transform: uppercase;
    letter-spacing: 2px;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
}

/* Bottom progress bar (thin elegant accent under header) */
/* Legacy stat classes (fallback) */
.collection-stats {
    display: flex;
    align-items: flex-end;
    gap: 0;
    margin-top: 20px;
    width: 100%;
    max-width: 320px;
}
.stat-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    flex: 1;
    position: relative;
}
.stat-item:not(:last-child)::after {
    content: '';
    position: absolute;
    right: 0;
    top: 4px;
    bottom: 4px;
    width: 1px;
    background: linear-gradient(to bottom, transparent, rgba(255, 215, 0, 0.2), transparent);
}
.stat-value {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    font-size: 1.6rem;
    color: #FFD700;
    font-weight: 700;
    line-height: 1;
}
.stat-label {
    font-size: 0.6rem;
    color: rgba(255, 255, 255, 0.35);
    text-transform: uppercase;
    letter-spacing: 1.5px;
    margin-top: 6px;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
}

.collection-content {
    flex: 1;
    overflow-y: auto;
    padding: 16px 20px 100px;
    -webkit-overflow-scrolling: touch;
    mask-image: linear-gradient(to bottom, transparent, black 16px, black 94%, transparent);
    -webkit-mask-image: linear-gradient(to bottom, transparent, black 16px, black 94%, transparent);
}

.collection-category-group {
    margin-bottom: 36px;
}

.collection-category-title {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    font-size: 0.72rem;
    font-weight: 600;
    letter-spacing: 3px;
    text-transform: uppercase;
    color: rgba(255, 215, 0, 0.7);
    margin-bottom: 18px;
    padding: 8px 14px;
    display: flex;
    align-items: center;
    gap: 0;
    position: relative;
    border-left: none;
}
.collection-category-title::before {
    content: '';
    position: absolute;
    left: 0;
    right: 0;
    bottom: 0;
    height: 1px;
    background: linear-gradient(90deg,
        rgba(255, 215, 0, 0.3),
        rgba(255, 215, 0, 0.08) 70%,
        transparent);
}
.collection-category-title .cat-stars {
    margin-right: 10px;
    font-size: 0.5rem;
    letter-spacing: 1px;
    opacity: 0.5;
}
.collection-category-title span {
    font-size: 0.72rem;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif;
    color: rgba(255, 215, 0, 0.45);
    margin-left: 10px;
    letter-spacing: 2px;
    font-weight: normal;
}
.collection-category-count {
    margin-left: auto;
    font-size: 0.6rem;
    color: rgba(255, 215, 0, 0.3);
    font-weight: 400;
    letter-spacing: 1px;
}

.collection-grid-new {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
    gap: 12px;
}

.collection-card {
    position: relative;
    aspect-ratio: 0.72;
    background: rgba(255, 255, 255, 0.015);
    border: 1px solid rgba(255, 255, 255, 0.04);
    border-radius: 10px;
    overflow: hidden;
    transition: all 0.35s cubic-bezier(0.34, 1.56, 0.64, 1);
    cursor: default;
}

.collection-card.collected {
    background: linear-gradient(160deg,
        rgba(50, 12, 12, 0.6) 0%,
        rgba(20, 5, 5, 0.85) 60%,
        rgba(30, 8, 8, 0.7) 100%);
    border-color: rgba(255, 215, 0, 0.15);
    cursor: pointer;
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.3);
}
.collection-card.collected::after {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: 10px;
    background: linear-gradient(135deg,
        rgba(255, 215, 0, 0.06) 0%,
        transparent 40%,
        transparent 60%,
        rgba(255, 215, 0, 0.03) 100%);
    pointer-events: none;
}
.collection-card.collected:hover {
    transform: translateY(-4px) scale(1.02);
    box-shadow: 0 10px 28px rgba(0, 0, 0, 0.5),
        0 0 16px rgba(255, 215, 0, 0.1);
    border-color: rgba(255, 215, 0, 0.5);
    z-index: 5;
}
.collection-card.collected:active {
    transform: translateY(-1px) scale(0.98);
    transition-duration: 0.1s;
}

.collection-card.uncollected {
    opacity: 0.25;
}
.collection-card.uncollected .card-char {
    filter: blur(8px);
    opacity: 0.2;
}
.collection-card.uncollected .card-meta,
.collection-card.uncollected .card-english {
    opacity: 0;
}

.card-inner {
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 8px 6px;
}

.card-char {
    font-size: 2.4rem;
    color: #FFF;
    margin-bottom: 6px;
    line-height: 1;
    /* Layered glow: sharp inner → mid halo → soft outer bloom */
    text-shadow:
        0 0 4px rgba(255, 225, 100, 0.9),
        0 0 12px rgba(255, 215, 0, 0.6),
        0 0 28px rgba(255, 200, 50, 0.35),
        0 0 50px rgba(255, 180, 0, 0.15);
    /* Entry + breathing composite animation */
    animation: cardCharAppear 0.6s ease-out both,
               charBreathe 3s ease-in-out 0.6s infinite;
}

@keyframes charBreathe {
    0%, 100% {
        text-shadow:
            0 0 4px rgba(255, 225, 100, 0.9),
            0 0 12px rgba(255, 215, 0, 0.6),
            0 0 28px rgba(255, 200, 50, 0.35),
            0 0 50px rgba(255, 180, 0, 0.15);
        transform: scale(1);
    }
    50% {
        text-shadow:
            0 0 6px rgba(255, 235, 130, 1),
            0 0 18px rgba(255, 215, 0, 0.75),
            0 0 36px rgba(255, 200, 50, 0.45),
            0 0 60px rgba(255, 180, 0, 0.2);
        transform: scale(1.06);
    }
}

@keyframes cardCharAppear {
    0%   { opacity: 0; transform: scale(0.3); }
    60%  { opacity: 1; transform: scale(1.08); }
    100% { opacity: 1; transform: scale(1); }
}

.card-meta {
    text-align: center;
    width: 100%; /* Ensure text truncation works */
}

.card-name {
    font-size: 0.68rem;
    color: rgba(255, 215, 0, 0.65);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 100%;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    letter-spacing: 0.5px;
}

.card-english {
    font-size: 0.55rem;
    color: rgba(255, 255, 255, 0.35);
    margin-bottom: 2px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 100%;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    letter-spacing: 0.5px;
}

.card-stars {
    font-size: 0.5rem;
    letter-spacing: 1px;
    color: #FFD700;
    opacity: 0.5;
    margin-top: 2px;
}

/* Rarity Variations */
.collection-card.r7 {
    border-color: rgba(255, 0, 0, 0.6);
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.3), 0 0 24px rgba(255, 0, 0, 0.15), 0 0 48px rgba(255, 215, 0, 0.08), inset 0 0 20px rgba(255, 0, 0, 0.1);
    animation: collectionR7Pulse 2.5s ease-in-out infinite;
}
@keyframes collectionR7Pulse {
    0%, 100% { box-shadow: 0 2px 12px rgba(0,0,0,0.3), 0 0 26px rgba(255,0,0,0.17), 0 0 48px rgba(255,215,0,0.06), inset 0 0 20px rgba(255,0,0,0.1); }
    50% { box-shadow: 0 2px 12px rgba(0,0,0,0.3), 0 0 32px rgba(255,0,0,0.22), 0 0 60px rgba(255,215,0,0.1), inset 0 0 22px rgba(255,0,0,0.13); }
}
.collection-card.r7 .card-char {
    color: #FF0000;
    text-shadow:
        0 0 6px rgba(255, 0, 0, 0.95),
        0 0 18px rgba(255, 0, 0, 0.7),
        0 0 36px rgba(255, 215, 0, 0.4),
        0 0 60px rgba(255, 0, 0, 0.25);
    animation: cardCharAppear 0.6s ease-out both,
               charBreatheR7 2.5s ease-in-out 0.6s infinite;
}
@keyframes charBreatheR7 {
    0%, 100% {
        text-shadow: 0 0 6px rgba(255,0,0,0.95), 0 0 18px rgba(255,0,0,0.7), 0 0 36px rgba(255,215,0,0.4), 0 0 60px rgba(255,0,0,0.25);
        transform: scale(1);
    }
    50% {
        text-shadow: 0 0 8px rgba(255,30,0,1), 0 0 22px rgba(255,0,0,0.8), 0 0 42px rgba(255,215,0,0.45), 0 0 68px rgba(255,0,0,0.28);
        transform: scale(1.02);
    }
}

.collection-card.r6 {
    border-color: rgba(255, 100, 30, 0.4);
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.3), 0 0 20px rgba(255, 69, 0, 0.08), inset 0 0 16px rgba(255, 69, 0, 0.08);
}
.collection-card.r6 .card-char {
    text-shadow:
        0 0 4px rgba(255, 120, 50, 0.95),
        0 0 14px rgba(255, 69, 0, 0.7),
        0 0 30px rgba(255, 69, 0, 0.4),
        0 0 55px rgba(255, 40, 0, 0.2);
    animation: cardCharAppear 0.6s ease-out both,
               charBreatheR6 3s ease-in-out 0.6s infinite;
}
@keyframes charBreatheR6 {
    0%, 100% {
        text-shadow: 0 0 4px rgba(255,120,50,0.95), 0 0 14px rgba(255,69,0,0.7), 0 0 30px rgba(255,69,0,0.4), 0 0 55px rgba(255,40,0,0.2);
        transform: scale(1);
    }
    50% {
        text-shadow: 0 0 5px rgba(255,130,60,1), 0 0 18px rgba(255,69,0,0.78), 0 0 35px rgba(255,69,0,0.45), 0 0 62px rgba(255,40,0,0.22);
        transform: scale(1.02);
    }
}

.collection-card.r5 {
    border-color: rgba(168, 85, 247, 0.35);
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.3), 0 0 16px rgba(168, 85, 247, 0.06), inset 0 0 14px rgba(168, 85, 247, 0.06);
}
.collection-card.r5 .card-char {
    text-shadow:
        0 0 4px rgba(200, 140, 255, 0.95),
        0 0 14px rgba(168, 85, 247, 0.7),
        0 0 30px rgba(168, 85, 247, 0.4),
        0 0 55px rgba(140, 50, 230, 0.2);
    animation: cardCharAppear 0.6s ease-out both,
               charBreatheR5 3s ease-in-out 0.6s infinite;
}
@keyframes charBreatheR5 {
    0%, 100% {
        text-shadow: 0 0 4px rgba(200,140,255,0.95), 0 0 14px rgba(168,85,247,0.7), 0 0 30px rgba(168,85,247,0.4), 0 0 55px rgba(140,50,230,0.2);
        transform: scale(1);
    }
    50% {
        text-shadow: 0 0 5px rgba(210,155,255,1), 0 0 18px rgba(168,85,247,0.78), 0 0 35px rgba(168,85,247,0.45), 0 0 62px rgba(140,50,230,0.22);
        transform: scale(1.02);
    }
}

.collection-actions {
    position: absolute;
    bottom: 28px;
    left: 0;
    right: 0;
    display: flex;
    justify-content: center;
    padding: 0 24px;
    pointer-events: none;
    z-index: 10;
}
.collection-actions .collection-pill-btn {
    pointer-events: auto;
}

/* ============================================================
   MONETIZATION UI — Auth bar, Login modal, Rewards panel
   ============================================================ */

/* --- Unified pill button for collection (Sign In, Close, Auth) --- */
.collection-pill-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    margin: 0;
    padding: 0 24px;
    height: 38px;
    border-radius: 19px;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    font-size: 11px;
    font-weight: 600;
    letter-spacing: 2.5px;
    text-transform: uppercase;
    color: rgba(255, 215, 0, 0.7);
    background: linear-gradient(135deg,
        rgba(40, 8, 8, 0.5) 0%,
        rgba(20, 4, 4, 0.4) 100%);
    backdrop-filter: blur(20px) saturate(1.5);
    -webkit-backdrop-filter: blur(20px) saturate(1.5);
    border: 1px solid rgba(255, 215, 0, 0.2);
    box-shadow:
        0 2px 12px rgba(0, 0, 0, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.04);
    cursor: pointer;
    transition: all 0.3s ease;
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
}
.collection-pill-btn:hover {
    color: rgba(255, 215, 0, 0.95);
    border-color: rgba(255, 215, 0, 0.4);
    background: linear-gradient(135deg,
        rgba(60, 12, 12, 0.6) 0%,
        rgba(30, 6, 6, 0.5) 100%);
    box-shadow:
        0 4px 20px rgba(0, 0, 0, 0.3),
        0 0 10px rgba(255, 215, 0, 0.06);
    transform: translateY(-1px);
}
.collection-pill-btn:active {
    transform: translateY(0) scale(0.97);
    transition-duration: 0.1s;
}
.collection-pill-sm {
    height: 30px;
    padding: 0 16px;
    font-size: 10px;
    letter-spacing: 1.5px;
}
.collection-progress-center,
.collection-progress-half {
    display: flex;
    align-items: center;
    justify-content: flex-end;
    gap: 14px;
    flex-shrink: 0;
}
.auth-logged-out-row {
    display: flex;
    align-items: center;
}
.auth-logged-in-row {
    display: flex;
    align-items: center;
    position: relative;
}
.auth-dropdown {
    position: absolute;
    top: calc(100% + 8px);
    right: 0;
    background: rgba(30, 5, 5, 0.95);
    border: 1px solid rgba(255, 215, 0, 0.2);
    border-radius: 12px;
    padding: 12px 16px;
    display: flex;
    flex-direction: column;
    gap: 10px;
    align-items: center;
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
    z-index: 10;
    min-width: 160px;
}

/* Gold-bordered sign-in button */
.btn-auth.btn-signin-gold {
    min-height: 48px;
    padding: 0 32px;
    border-radius: 6px;
    font-size: 14px;
    font-weight: 700;
    letter-spacing: 2.5px;
    text-transform: uppercase;
    color: #FFD700;
    text-shadow: 0 0 12px rgba(255, 215, 0, 0.3);
    background: linear-gradient(135deg,
        rgba(255, 215, 0, 0.12) 0%,
        rgba(180, 120, 0, 0.10) 50%,
        rgba(255, 215, 0, 0.08) 100%);
    border: 2px solid rgba(255, 215, 0, 0.5);
    box-shadow:
        0 0 16px rgba(255, 215, 0, 0.10),
        0 2px 8px rgba(0, 0, 0, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.06);
    transition: all 0.3s ease;
    cursor: pointer;
}
.btn-auth.btn-signin-gold:hover {
    background: linear-gradient(135deg,
        rgba(255, 215, 0, 0.22) 0%,
        rgba(200, 140, 0, 0.15) 50%,
        rgba(255, 215, 0, 0.12) 100%);
    border-color: rgba(255, 215, 0, 0.75);
    color: #FFE44D;
    box-shadow:
        0 0 24px rgba(255, 215, 0, 0.18),
        0 4px 12px rgba(0, 0, 0, 0.25),
        inset 0 1px 0 rgba(255, 255, 255, 0.08);
    transform: translateY(-1px);
}
.btn-auth.btn-signin-gold:active {
    transform: scale(0.97);
    transition-duration: 0.1s;
}

/* User badge: inherits gold border, shows truncated name */
.btn-user-badge {
    max-width: 160px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

/* --- Draw Counter (inline in bottom controls, left of toggle) --- */
.draw-counter-float {
    pointer-events: auto;
    display: flex;
    align-items: center;
    opacity: 0;
    transform: translateY(20px);
    visibility: hidden;
    transition: all 0.3s ease;
}
.draw-counter-float.visible {
    opacity: 1;
    transform: translateY(0);
    visibility: visible;
}
.btn-auth {
    background: linear-gradient(135deg,
        rgba(255, 255, 255, 0.12) 0%,
        rgba(255, 255, 255, 0.04) 100%);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border: 1px solid rgba(255, 255, 255, 0.18);
    color: rgba(255, 255, 255, 0.9);
    padding: 6px 16px;
    border-radius: 16px;
    font-size: 12px;
    font-weight: 500;
    letter-spacing: 0.3px;
    cursor: pointer;
    transition: all 0.25s ease;
    box-shadow:
        0 2px 8px rgba(0, 0, 0, 0.15),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
}
.btn-auth:hover {
    background: linear-gradient(135deg,
        rgba(255, 255, 255, 0.18) 0%,
        rgba(255, 215, 0, 0.08) 100%);
    border-color: rgba(255, 215, 0, 0.3);
    color: #FFD700;
    box-shadow:
        0 4px 16px rgba(0, 0, 0, 0.2),
        0 0 12px rgba(255, 215, 0, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.15);
    transform: translateY(-1px);
}
.btn-auth:active {
    transform: translateY(0);
    box-shadow: 0 1px 4px rgba(0, 0, 0, 0.2);
}
.btn-auth.btn-small {
    padding: 4px 12px;
    font-size: 10px;
    opacity: 0.6;
    border-color: rgba(255, 255, 255, 0.1);
}
.btn-auth.btn-small:hover {
    opacity: 1;
}
.auth-email {
    color: rgba(255, 255, 255, 0.7);
    font-size: 11px;
    max-width: 100px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    letter-spacing: 0.2px;
}

/* --- Draw Counter Badge --- */
.draw-counter {
    background: rgba(0, 0, 0, 0.3);
    border: 1.5px solid rgba(255, 215, 0, 0.4);
    color: #FFD700;
    padding: 0 16px;
    border-radius: 24px;
    font-size: 15px;
    font-weight: 700;
    white-space: nowrap;
    height: 48px;
    display: flex;
    align-items: center;
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    animation: drawCounterPulse 2s ease-in-out infinite;
}
@keyframes drawCounterPulse {
    0%, 100% { box-shadow: 0 0 4px rgba(255, 215, 0, 0.2); }
    50% { box-shadow: 0 0 12px rgba(255, 215, 0, 0.4); }
}

/* --- Share Preview Modal --- */
.share-preview-backdrop {
    position: fixed;
    inset: 0;
    z-index: 3000;
    background: rgba(0, 0, 0, 0.7);
    backdrop-filter: blur(6px);
    -webkit-backdrop-filter: blur(6px);
}
.share-preview-modal {
    position: fixed;
    inset: 0;
    z-index: 3001;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
}
.share-preview-inner {
    max-width: 380px;
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 20px;
    animation: cardAppear 0.35s ease-out;
}
.share-preview-img {
    width: 100%;
    max-height: 65vh;
    object-fit: contain;
    border-radius: 12px;
    box-shadow: 0 8px 40px rgba(0, 0, 0, 0.6), 0 0 20px rgba(255, 215, 0, 0.15);
    border: 1px solid rgba(255, 215, 0, 0.25);
}
.share-preview-actions {
    display: flex;
    gap: 12px;
    width: 100%;
    justify-content: center;
    flex-wrap: wrap;
}
.share-preview-btn {
    min-width: 100px;
    padding: 12px 20px;
    font-size: 14px;
    border-radius: 10px;
}

/* --- Login Modal --- */
.modal-overlay {
    position: fixed;
    inset: 0;
    z-index: 2000;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(0, 0, 0, 0.7);
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
}
.modal-card {
    background: linear-gradient(135deg, rgba(60, 10, 10, 0.95), rgba(30, 5, 5, 0.98));
    border: 1px solid rgba(255, 215, 0, 0.3);
    border-radius: 16px;
    padding: 32px;
    width: min(360px, 90vw);
    text-align: center;
    box-shadow: 0 8px 40px rgba(0, 0, 0, 0.6);
}
.modal-card h2 {
    color: #FFD700;
    font-size: 24px;
    margin: 0 0 8px;
}
.modal-card p {
    color: rgba(255, 255, 255, 0.7);
    font-size: 14px;
    margin: 0 0 20px;
}
.input-email {
    width: 100%;
    padding: 12px 16px;
    border: 1px solid rgba(255, 215, 0, 0.3);
    border-radius: 10px;
    background: rgba(0, 0, 0, 0.4);
    color: white;
    font-size: 16px;
    margin-bottom: 16px;
    box-sizing: border-box;
    outline: none;
    transition: border-color 0.2s;
}
.input-email:focus {
    border-color: rgba(255, 215, 0, 0.6);
}
.input-email::placeholder {
    color: rgba(255, 255, 255, 0.3);
}
.modal-card .btn-action {
    width: 100%;
    margin-bottom: 8px;
}
.login-status {
    color: rgba(255, 215, 0, 0.8);
    font-size: 13px;
    min-height: 18px;
    margin: 8px 0 0;
}

/* --- Payment Modal --- */
.payment-modal-card {
    width: min(420px, 92vw);
}

.promo-code-row {
    display: flex;
    flex-direction: column;
    align-items: stretch;
    gap: 10px;
    margin-bottom: 12px;
}

#promo-code {
    width: 100%;
    padding: 10px 12px;
    border: 1px solid rgba(255, 215, 0, 0.3);
    border-radius: 10px;
    background: rgba(0, 0, 0, 0.45);
    color: #fff;
    font-size: 14px;
    box-sizing: border-box;
    outline: none;
}

#promo-code::placeholder {
    color: rgba(255, 255, 255, 0.35);
}

#promo-code:focus {
    border-color: rgba(255, 215, 0, 0.6);
}

#btn-apply-promo {
    width: 100%;
    min-width: 0;
    margin-bottom: 0;
}

#payment-element {
    margin-bottom: 16px;
    min-height: 100px;
}

.payment-status {
    color: rgba(255, 215, 0, 0.8);
    font-size: 13px;
    min-height: 18px;
    margin: 0 0 12px;
}

.payment-status.error {
    color: #f87171;
}

.payment-status.success {
    color: #4ADE80;
}

#btn-pay:disabled {
    opacity: 0.4;
    cursor: not-allowed;
}

/* --- Rewards Panel Backdrop --- */
.rewards-backdrop {
    position: fixed;
    inset: 0;
    z-index: 1499;
    background: rgba(0, 0, 0, 0.45);
    backdrop-filter: blur(6px);
    -webkit-backdrop-filter: blur(6px);
    animation: rp-fadeIn 0.2s ease-out;
}
@keyframes rp-fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

/* --- Rewards Panel (frosted glass drawer) --- */
.rewards-panel {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 1500;
    display: flex;
    flex-direction: column;
    max-height: 72vh;
    /* True frosted glass — mostly transparent, heavy blur */
    background: rgba(20, 0, 0, 0.42);
    backdrop-filter: blur(60px) saturate(1.6);
    -webkit-backdrop-filter: blur(60px) saturate(1.6);
    border-radius: 20px 20px 0 0;
    border-top: 1px solid rgba(255, 255, 255, 0.08);
    box-shadow:
        0 -4px 60px rgba(0, 0, 0, 0.5),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
    animation: rp-slideUp 0.32s cubic-bezier(0.32, 0.72, 0, 1);
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
}
@keyframes rp-slideUp {
    from { transform: translateY(100%); }
    to { transform: translateY(0); }
}

/* Drag handle */
.rewards-handle {
    display: flex;
    justify-content: center;
    padding: 8px 0 0;
}
.rewards-handle-bar {
    width: 32px;
    height: 3px;
    border-radius: 1.5px;
    background: rgba(255, 255, 255, 0.14);
}

/* Header */
.rewards-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 10px 18px 8px;
}
.rewards-title {
    color: #FFD700;
    font-size: 17px;
    font-weight: 700;
    letter-spacing: -0.2px;
    text-shadow: 0 0 16px rgba(255, 215, 0, 0.4), 0 0 40px rgba(255, 215, 0, 0.15);
}
.rewards-close {
    background: rgba(255, 255, 255, 0.06);
    border: none;
    color: rgba(255, 255, 255, 0.4);
    width: 28px;
    height: 28px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.15s;
}
.rewards-close:hover {
    background: rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 0.7);
}

/* Scrollable content */
.rewards-content {
    overflow-y: auto;
    padding: 2px 16px 28px;
    -webkit-overflow-scrolling: touch;
    display: flex;
    flex-direction: column;
    gap: 12px;
}

/* --- Sign In row in rewards panel --- */
.rewards-signin-row {
    display: flex;
    padding: 0;
}
.rewards-signin-btn {
    border-color: rgba(255, 215, 0, 0.3);
    background: rgba(255, 215, 0, 0.08);
}
.rewards-signin-btn:hover {
    background: rgba(255, 215, 0, 0.15);
    border-color: rgba(255, 215, 0, 0.5);
}
.rewards-user-row {
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
}
.rewards-user-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 8px 18px;
    background: rgba(255, 255, 255, 0.04);
    border: 1px solid rgba(255, 255, 255, 0.08);
    border-radius: 10px;
    color: rgba(255, 215, 0, 0.7);
    font-family: inherit;
    font-size: 12px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.15s ease;
    max-width: 200px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}
.rewards-user-badge:hover {
    border-color: rgba(255, 215, 0, 0.2);
    background: rgba(255, 255, 255, 0.06);
}
.rewards-btn--small {
    padding: 8px 14px;
    font-size: 11px;
}

/* Section glass card */
.rewards-section {
    background: rgba(255, 255, 255, 0.04);
    border: 1px solid rgba(255, 255, 255, 0.06);
    border-radius: 14px;
    padding: 4px 0;
    overflow: hidden;
}
.rewards-section-label {
    display: block;
    padding: 10px 14px 6px;
    font-size: 10px;
    font-weight: 600;
    letter-spacing: 0.6px;
    text-transform: uppercase;
    color: rgba(255, 215, 0, 0.55);
}

/* Row inside section */
.rewards-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 14px;
    gap: 10px;
}
.rewards-row--actions {
    gap: 8px;
    align-items: stretch;
}
.rewards-row--meta {
    padding-top: 0;
    gap: 6px;
}
.rewards-row--meta:empty,
.rewards-row--meta:not(:has(.cooldown-text:not(:empty))) {
    display: none;
}
.rewards-row-text {
    color: rgba(255, 255, 255, 0.82);
    font-size: 13px;
    font-weight: 500;
}
.rewards-row-sub {
    color: rgba(255, 255, 255, 0.35);
    font-size: 10px;
}

/* Thin divider between rows */
.rewards-divider {
    height: 1px;
    margin: 0 14px;
    background: rgba(255, 255, 255, 0.05);
}

/* Action buttons — minimal, clean */
.rewards-btn {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 6px 14px;
    background: rgba(255, 215, 0, 0.1);
    border: 1px solid rgba(255, 215, 0, 0.18);
    color: #FFD700;
    border-radius: 8px;
    font-family: inherit;
    font-size: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.15s ease;
    white-space: nowrap;
    flex-shrink: 0;
}
.rewards-btn:hover {
    background: rgba(255, 215, 0, 0.18);
    border-color: rgba(255, 215, 0, 0.35);
}
.rewards-btn:active {
    transform: scale(0.97);
}
.rewards-btn:disabled {
    opacity: 0.35;
    cursor: not-allowed;
    transform: none;
}
.rewards-btn--fill {
    flex: 1;
    justify-content: center;
    flex-direction: column;
    gap: 5px;
    padding: 14px 6px;
    font-size: 13px;
    border-radius: 10px;
}
.rewards-btn--static {
    cursor: default;
    background: rgba(255, 255, 255, 0.04);
    border-color: rgba(255, 255, 255, 0.08);
    color: rgba(255, 255, 255, 0.7);
}
.rewards-btn--static:hover {
    background: rgba(255, 255, 255, 0.04);
    border-color: rgba(255, 255, 255, 0.08);
}
.rewards-btn--sm {
    padding: 5px 12px;
    font-size: 11px;
}
.rewards-btn-sub {
    font-size: 10px;
    font-weight: 500;
    color: rgba(255, 255, 255, 0.35);
}
.rewards-btn-badge {
    font-size: 11px;
    font-weight: 700;
    color: rgba(255, 215, 0, 0.9);
    background: rgba(255, 215, 0, 0.12);
    padding: 1px 6px;
    border-radius: 5px;
    letter-spacing: 0.3px;
}

/* Cooldown text */
.cooldown-text {
    color: rgba(255, 255, 255, 0.3);
    font-size: 11px;
    font-family: inherit;
}

/* Streak dots */
.streak-dots {
    display: flex;
    gap: 5px;
    margin-left: auto;
}

/* --- Purchase Grid --- */
.purchase-grid {
    display: flex;
    gap: 8px;
    padding: 6px 14px 12px;
}
.btn-purchase {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    padding: 16px 6px 12px;
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.06);
    border-radius: 10px;
    cursor: pointer;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    transition: all 0.15s ease;
}
.btn-purchase:hover {
    background: rgba(255, 215, 0, 0.06);
    border-color: rgba(255, 215, 0, 0.25);
    transform: translateY(-1px);
}
.btn-purchase:active {
    transform: scale(0.97);
}
.btn-purchase:disabled {
    opacity: 0.35;
    transform: none;
}
.purchase-draws {
    color: rgba(255, 255, 255, 0.9);
    font-size: 14px;
    font-weight: 700;
}
.purchase-price {
    color: #FFD700;
    font-size: 18px;
    font-weight: 700;
    letter-spacing: -0.3px;
}
.purchase-savings {
    color: #4ADE80;
    font-size: 9px;
    font-weight: 600;
    background: rgba(74, 222, 128, 0.1);
    padding: 1px 5px;
    border-radius: 4px;
}

/* --- Share Result Button (fortune screen) --- */
.single-fortune-actions {
    position: fixed;
    left: 0;
    right: 0;
    bottom: 7%;
    display: none;
    align-items: center;
    justify-content: center;
    pointer-events: none;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.2s ease;
    z-index: 15;
}
.single-fortune-actions.visible {
    display: flex;
    opacity: 1;
    visibility: visible;
}
.single-fortune-actions > * {
    pointer-events: auto;
}
.single-fortune-actions .btn-share-result {
    margin: 0;
    height: 48px;
    padding: 0 24px !important;
    border-radius: 30px !important;
    font-size: 0.9rem !important;
    font-weight: 600;
    letter-spacing: 2px;
    text-transform: uppercase;
    background: linear-gradient(135deg, #8f0000 0%, #c31414 52%, #f0b020 100%) !important;
    border: 1.5px solid rgba(255, 210, 90, 0.75) !important;
    color: #ffe8a8 !important;
    box-shadow:
        0 4px 16px rgba(110, 0, 0, 0.35),
        0 0 14px rgba(255, 190, 40, 0.25);
}
.single-fortune-actions .btn-share-result:hover {
    background: linear-gradient(135deg, #a40000 0%, #d11818 52%, #ffbf2e 100%) !important;
    border-color: rgba(255, 220, 120, 0.9) !important;
    color: #fff2c8 !important;
    box-shadow:
        0 6px 18px rgba(130, 0, 0, 0.4),
        0 0 18px rgba(255, 200, 60, 0.35);
}
@media (max-width: 520px) {
    .single-fortune-actions .btn-share-result {
        height: 44px;
        padding: 0 16px !important;
        font-size: 0.78rem !important;
        letter-spacing: 1px;
    }
}
.btn-share-result {
    background: linear-gradient(135deg,
        rgba(255, 255, 255, 0.1) 0%,
        rgba(255, 255, 255, 0.04) 50%,
        rgba(255, 215, 0, 0.06) 100%) !important;
    backdrop-filter: blur(16px) saturate(1.4) !important;
    -webkit-backdrop-filter: blur(16px) saturate(1.4) !important;
    border: 1px solid rgba(255, 255, 255, 0.15) !important;
    color: rgba(255, 255, 255, 0.85) !important;
    padding: 8px 24px !important;
    border-radius: 20px !important;
    font-size: 12px !important;
    font-weight: 500;
    letter-spacing: 1px;
    cursor: pointer;
    transition: all 0.25s ease;
    box-shadow:
        0 4px 20px rgba(0, 0, 0, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
}
.btn-share-result:hover {
    background: linear-gradient(135deg,
        rgba(255, 255, 255, 0.16) 0%,
        rgba(255, 215, 0, 0.1) 100%) !important;
    border-color: rgba(255, 215, 0, 0.3) !important;
    color: #FFD700 !important;
    box-shadow:
        0 4px 24px rgba(0, 0, 0, 0.25),
        0 0 16px rgba(255, 215, 0, 0.1);
    transform: translateY(-1px);
}

/* --- Detail popup action buttons --- */
.detail-actions {
    display: flex;
    gap: 12px;
    justify-content: center;
    flex-wrap: wrap;
    width: 100%;
}
.detail-actions-outside {
    max-width: min(420px, 88vw);
    padding: 0 8px;
}
.btn-detail-action {
    background: linear-gradient(135deg,
        rgba(176, 22, 22, 0.9) 0%,
        rgba(142, 14, 14, 0.92) 56%,
        rgba(110, 10, 10, 0.9) 100%);
    backdrop-filter: blur(14px) saturate(1.1);
    -webkit-backdrop-filter: blur(14px) saturate(1.1);
    border: 1px solid rgba(255, 218, 128, 0.58);
    box-shadow:
        0 6px 16px rgba(100, 0, 0, 0.42),
        0 0 12px rgba(255, 184, 64, 0.2),
        inset 0 1px 0 rgba(255, 238, 190, 0.25);
    color: #FFD700;
    min-width: 104px;
    padding: 11px 24px;
    border-radius: 24px;
    font-size: 12px;
    font-weight: 600;
    letter-spacing: 1.4px;
    text-transform: uppercase;
    cursor: pointer;
    transition: all 0.25s ease;
}
.btn-detail-action:hover {
    background: linear-gradient(135deg,
        rgba(198, 28, 28, 0.94) 0%,
        rgba(158, 18, 18, 0.96) 56%,
        rgba(124, 12, 12, 0.94) 100%);
    border-color: rgba(255, 225, 146, 0.78);
    color: #FFF1BE;
    transform: translateY(-1px);
    box-shadow:
        0 8px 22px rgba(120, 0, 0, 0.48),
        0 0 18px rgba(255, 198, 86, 0.3);
}
.btn-detail-sound.playing {
    border-color: rgba(255, 220, 120, 0.72);
    color: #FFE6A8;
    box-shadow:
        0 8px 24px rgba(0, 0, 0, 0.32),
        0 0 20px rgba(255, 195, 80, 0.35);
}
.btn-detail-pronunciation {
    flex-basis: 100%;
    margin-top: 2px;
    max-width: 220px;
}
